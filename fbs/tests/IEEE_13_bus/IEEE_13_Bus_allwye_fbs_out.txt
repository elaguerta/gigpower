============================= test session starts ==============================
platform darwin -- Python 3.8.5, pytest-6.0.1, py-1.9.0, pluggy-0.13.1
rootdir: /Users/elainelaguerta/Dropbox/LBNL/LinDist3Flow/fbs
plugins: cov-2.10.1
collected 1 item

fbs/tests/test_compare_opendss.py 

Testing File: /Users/elainelaguerta/Dropbox/LBNL/python-powerflow/IEEE_13_Node/IEEE_13_Bus_allwye_noxfm_noreg.dss

Opendss Iterations: 3	Opendss Convergence: 0.0001
FBS iterations: 12	 FBS convergence:5.070223414651447e-10	 FBS tolerance: 1e-09


COMPARE V
Max |diff|:
A.(fbs - dss)   0.0106
B.(fbs - dss)   0.0079
C.(fbs - dss)   0.0184
dtype: float64
            A.(fbs - dss)  B.(fbs - dss)   C.(fbs - dss)
sourcebus  0.0001+0.0002j 0.0001-0.0001j -0.0002+0.0000j
671       -0.0033-0.0098j 0.0010-0.0077j  0.0126-0.0122j
634       -0.0015-0.0050j 0.0006-0.0042j  0.0068-0.0066j
645        0.0000+0.0000j 0.0005-0.0042j  0.0067-0.0065j
646        0.0000+0.0000j 0.0005-0.0042j  0.0067-0.0066j
692       -0.0033-0.0098j 0.0010-0.0077j  0.0126-0.0122j
675       -0.0039-0.0099j 0.0008-0.0079j  0.0126-0.0127j
611        0.0000+0.0000j 0.0000+0.0000j  0.0131-0.0129j
652       -0.0037-0.0096j 0.0000+0.0000j -0.0000+0.0000j
670       -0.0021-0.0066j 0.0008-0.0054j  0.0087-0.0084j
650        0.0001-0.0001j 0.0001-0.0003j  0.0001-0.0003j
632       -0.0015-0.0050j 0.0006-0.0042j  0.0067-0.0064j
680       -0.0033-0.0098j 0.0010-0.0077j  0.0126-0.0122j
633       -0.0015-0.0050j 0.0006-0.0042j  0.0067-0.0065j
684       -0.0034-0.0098j 0.0000+0.0000j  0.0128-0.0125j 

FBS results
                       A               B               C
sourcebus 1.0000+0.0000j -0.5000-0.8660j -0.5000+0.8660j
671       0.9160-0.1083j -0.5365-0.8530j -0.3844+0.8010j
634       0.9484-0.0549j -0.5186-0.8396j -0.4280+0.8280j
645       0.0000+0.0000j -0.5144-0.8341j -0.4278+0.8325j
646       0.0000+0.0000j -0.5131-0.8320j -0.4261+0.8312j
692       0.9160-0.1083j -0.5365-0.8530j -0.3844+0.8010j
675       0.9086-0.1117j -0.5406-0.8532j -0.3839+0.7988j
611       0.0000+0.0000j  0.0000+0.0000j -0.3786+0.7983j
652       0.9080-0.1065j  0.0000+0.0000j -0.0000+0.0000j
670       0.9423-0.0713j -0.5245-0.8461j -0.4133+0.8217j
650       0.9978-0.0025j -0.5009-0.8650j -0.4967+0.8644j
632       0.9547-0.0527j -0.5191-0.8438j -0.4307+0.8328j
680       0.9160-0.1083j -0.5365-0.8530j -0.3844+0.8010j
633       0.9516-0.0538j -0.5189-0.8417j -0.4293+0.8304j
684       0.9139-0.1086j  0.0000+0.0000j -0.3818+0.7995j 

DSS results
                       A               B               C
sourcebus 0.9999-0.0002j -0.5001-0.8659j -0.4998+0.8660j
671       0.9193-0.0985j -0.5375-0.8452j -0.3970+0.8131j
634       0.9499-0.0498j -0.5192-0.8354j -0.4347+0.8346j
645       0.0000+0.0000j -0.5150-0.8299j -0.4344+0.8390j
646       0.0000+0.0000j -0.5137-0.8278j -0.4327+0.8378j
692       0.9193-0.0985j -0.5375-0.8452j -0.3970+0.8131j
675       0.9125-0.1019j -0.5413-0.8453j -0.3965+0.8115j
611       0.0000+0.0000j  0.0000+0.0000j -0.3916+0.8112j
652       0.9118-0.0969j  0.0000+0.0000j  0.0000+0.0000j
670       0.9444-0.0647j -0.5253-0.8407j -0.4220+0.8301j
650       0.9978-0.0024j -0.5010-0.8646j -0.4968+0.8647j
632       0.9563-0.0477j -0.5197-0.8396j -0.4373+0.8392j
680       0.9193-0.0985j -0.5375-0.8452j -0.3970+0.8131j
633       0.9531-0.0488j -0.5195-0.8375j -0.4360+0.8369j
684       0.9173-0.0988j  0.0000+0.0000j -0.3947+0.8120j


COMPARE VMag (LN)
Max |diff|:
A.(fbs - dss)   25.4808
B.(fbs - dss)   18.9727
C.(fbs - dss)   44.0834
dtype: float64
             A.(fbs - dss)   B.(fbs - dss)    C.(fbs - dss)
sourcebus   0.3348+0.3647j  0.1320-0.3478j  -0.4875+0.0861j
671       -7.8604-23.4198j 2.3968-18.5670j 30.2072-29.2360j
634       -3.6038-12.0304j 1.4520-10.0858j 16.2152-15.7384j
645         0.0000+0.0000j  1.2685-9.9877j 16.0365-15.6734j
646         0.0000+0.0000j  1.2466-9.9998j 16.0747-15.8040j
692       -7.8604-23.4198j 2.3968-18.5670j 30.2072-29.2360j
675       -9.3770-23.6927j 1.8230-18.8849j 30.2069-30.4825j
611         0.0000+0.0000j  0.0000+0.0000j 31.4191-30.9223j
652       -8.9720-23.0546j  0.0000+0.0000j  -0.0000+0.0000j
670       -4.9822-15.8852j 1.8257-12.9168j 20.9402-20.1588j
650         0.1446-0.2257j  0.1942-0.8075j   0.2969-0.6534j
632       -3.6586-12.0340j 1.4371-10.0016j 15.9846-15.4440j
680       -7.8605-23.4198j 2.3968-18.5669j 30.2072-29.2360j
633       -3.6312-12.0322j 1.4446-10.0437j 16.0999-15.5913j
684       -8.1058-23.5292j  0.0000+0.0000j 30.7505-30.0971j 

FBS results
                            A                     B                     C
sourcebus   2401.7771+0.0000j -1200.8886-2080.0000j -1200.8886+2080.0000j
671       2200.1113-260.1047j -1288.5959-2048.6645j  -923.2467+1923.7526j
634       2277.8101-131.7555j -1245.4728-2016.4569j -1027.8889+1988.7056j
645            0.0000+0.0000j -1235.5629-2003.3137j -1027.3973+1999.4543j
646            0.0000+0.0000j -1232.4318-1998.2469j -1023.2783+1996.4578j
692       2200.1113-260.1047j -1288.5959-2048.6645j  -923.2467+1923.7526j
675       2182.2204-268.3189j -1298.3607-2049.1957j  -921.9999+1918.4505j
611            0.0000+0.0000j        0.0000+0.0000j  -909.2014+1917.4208j
652       2180.8622-255.6724j        0.0000+0.0000j       -0.0000+0.0000j
670       2263.2497-171.1885j -1259.7111-2032.1682j  -992.6230+1973.5811j
650         2396.5995-6.0328j -1203.0774-2077.4560j -1192.9618+2076.1999j
632       2293.0467-126.6878j -1246.8538-2026.5765j -1034.4270+2000.1988j
680       2200.1113-260.1047j -1288.5959-2048.6645j  -923.2467+1923.7526j
633       2285.4284-129.2216j -1246.1633-2021.5167j -1031.1580+1994.4522j
684       2194.9606-260.7182j        0.0000+0.0000j  -917.1148+1920.1673j 

DSS results
                            A                     B                     C
sourcebus   2401.4424-0.3647j -1201.0206-2079.6522j -1200.4011+2079.9139j
671       2207.9718-236.6848j -1290.9927-2030.0975j  -953.4539+1952.9886j
634       2281.4139-119.7251j -1246.9248-2006.3711j -1044.1041+2004.4440j
645            0.0000+0.0000j -1236.8314-1993.3260j -1043.4338+2015.1277j
646            0.0000+0.0000j -1233.6784-1988.2471j -1039.3530+2012.2618j
692       2207.9717-236.6848j -1290.9927-2030.0975j  -953.4539+1952.9886j
675       2191.5974-244.6262j -1300.1837-2030.3108j  -952.2069+1948.9329j
611            0.0000+0.0000j        0.0000+0.0000j  -940.6205+1948.3431j
652       2189.8342-232.6178j        0.0000+0.0000j        0.0000+0.0000j
670       2268.2319-155.3034j -1261.5368-2019.2514j -1013.5632+1993.7399j
650         2396.4549-5.8070j -1203.2715-2076.6485j -1193.2588+2076.8533j
632       2296.7053-114.6538j -1248.2910-2016.5749j -1050.4117+2015.6429j
680       2207.9718-236.6849j -1290.9927-2030.0975j  -953.4539+1952.9886j
633       2289.0596-117.1895j -1247.6079-2011.4730j -1047.2579+2010.0435j
684       2203.0664-237.1890j        0.0000+0.0000j  -947.8653+1950.2644j


COMPARE I
Max |diff|:
A.(fbs - dss)   0.0792
B.(fbs - dss)   0.0073
C.(fbs - dss)   0.1414
dtype: float64
               A.(fbs - dss)   B.(fbs - dss)  C.(fbs - dss)
line_sbs_650  0.0562-0.0559j  0.0070-0.0019j 0.0281+0.1386j
line_650_632  0.0562-0.0559j  0.0070-0.0019j 0.0281+0.1386j
line_632_670  0.0567-0.0549j  0.0052-0.0012j 0.0264+0.1321j
line_670_671  0.0567-0.0547j  0.0049-0.0011j 0.0254+0.1258j
line_671_680 -0.0000-0.0000j -0.0000+0.0000j 0.0000+0.0000j
line_632_633 -0.0005-0.0010j  0.0005-0.0002j 0.0011+0.0036j
line_633_634 -0.0005-0.0010j  0.0005-0.0002j 0.0011+0.0036j
line_632_645  0.0000+0.0000j  0.0013-0.0005j 0.0006+0.0029j
line_645_646  0.0000+0.0000j  0.0005-0.0002j 0.0006+0.0029j
line_692_675  0.0299-0.0226j  0.0021-0.0001j 0.0122+0.0419j
line_671_684  0.0071-0.0083j  0.0000+0.0000j 0.0026+0.0236j
line_684_611  0.0000+0.0000j  0.0000+0.0000j 0.0026+0.0236j
line_684_652  0.0071-0.0083j  0.0000+0.0000j 0.0000+0.0000j
line_671_692  0.0331-0.0281j  0.0021-0.0001j 0.0164+0.0538j 

FBS results
                          A               B               C
line_sbs_650 1.2741-0.6973j -0.8303-0.5770j -0.0577+1.5238j
line_650_632 1.2741-0.6973j -0.8303-0.5770j -0.0577+1.5238j
line_632_670 1.1146-0.5735j -0.3721-0.3770j -0.0905+1.2282j
line_670_671 1.0977-0.5617j -0.3048-0.3408j -0.0993+1.0842j
line_671_680 0.0000+0.0000j -0.0000+0.0000j  0.0000+0.0000j
line_632_633 0.1595-0.1238j -0.1410-0.0554j  0.0262+0.1561j
line_633_634 0.1595-0.1238j -0.1410-0.0554j  0.0262+0.1561j
line_632_645 0.0000+0.0000j -0.3172-0.1446j  0.0066+0.1395j
line_645_646 0.0000+0.0000j -0.1186-0.0643j  0.0066+0.1395j
line_692_675 0.5126-0.0834j  0.0842-0.1333j -0.0879+0.3110j
line_671_684 0.1254-0.1075j  0.0000+0.0000j -0.0804+0.1689j
line_684_611 0.0000+0.0000j  0.0000+0.0000j -0.0804+0.1689j
line_684_652 0.1254-0.1075j  0.0000+0.0000j  0.0000+0.0000j
line_671_692 0.5930-0.1738j  0.0842-0.1333j -0.0536+0.4307j 

DSS results
                          A               B               C
line_sbs_650 1.2179-0.6414j -0.8373-0.5751j -0.0858+1.3852j
line_650_632 1.2179-0.6414j -0.8373-0.5751j -0.0858+1.3852j
line_632_670 1.0579-0.5186j -0.3773-0.3758j -0.1170+1.0960j
line_670_671 1.0410-0.5070j -0.3096-0.3397j -0.1247+0.9584j
line_671_680 0.0000+0.0000j  0.0000-0.0000j -0.0000-0.0000j
line_632_633 0.1600-0.1228j -0.1416-0.0551j  0.0251+0.1525j
line_633_634 0.1600-0.1228j -0.1416-0.0551j  0.0251+0.1525j
line_632_645 0.0000+0.0000j -0.3185-0.1442j  0.0060+0.1366j
line_645_646 0.0000+0.0000j -0.1190-0.0642j  0.0060+0.1366j
line_692_675 0.4827-0.0608j  0.0822-0.1332j -0.1001+0.2690j
line_671_684 0.1184-0.0991j  0.0000+0.0000j -0.0831+0.1453j
line_684_611 0.0000+0.0000j  0.0000+0.0000j -0.0831+0.1453j
line_684_652 0.1184-0.0991j  0.0000+0.0000j  0.0000+0.0000j
line_671_692 0.5599-0.1457j  0.0822-0.1332j -0.0700+0.3769j


COMPARE Stx
Max |diff|:
A.(fbs - dss)   0.0795
B.(fbs - dss)   0.0071
C.(fbs - dss)   0.1416
dtype: float64
               A.(fbs - dss)   B.(fbs - dss)   C.(fbs - dss)
line_sbs_650  0.0563+0.0561j -0.0018-0.0069j  0.1060+0.0939j
line_650_632  0.0563+0.0555j -0.0018-0.0067j  0.1055+0.0930j
line_632_670  0.0580+0.0433j -0.0004-0.0032j  0.0908+0.0724j
line_670_671  0.0585+0.0396j -0.0001-0.0028j  0.0837+0.0656j
line_671_680  0.0000+0.0000j -0.0000+0.0000j -0.0000+0.0000j
line_632_633 -0.0001-0.0000j  0.0001+0.0000j  0.0017+0.0013j
line_633_634 -0.0001-0.0000j  0.0001+0.0000j  0.0017+0.0013j
line_632_645  0.0000-0.0000j  0.0001+0.0001j  0.0013+0.0008j
line_645_646  0.0000+0.0000j  0.0001+0.0000j  0.0013+0.0008j
line_692_675  0.0288+0.0126j  0.0001-0.0023j  0.0244+0.0238j
line_671_684  0.0079+0.0054j -0.0000+0.0000j  0.0151+0.0104j
line_684_611  0.0000-0.0000j  0.0000+0.0000j  0.0150+0.0103j
line_684_652  0.0079+0.0054j  0.0000+0.0000j  0.0000+0.0000j
line_671_692  0.0329+0.0162j  0.0001-0.0023j  0.0313+0.0299j 

FBS results
                          A               B              C
line_sbs_650 1.2741+0.6973j  0.9148+0.4306j 1.3485+0.7119j
line_650_632 1.2731+0.6926j  0.9150+0.4292j 1.3459+0.7070j
line_632_670 1.0944+0.4887j  0.5113+0.1182j 1.0618+0.4536j
line_670_671 1.0744+0.4511j  0.4482+0.0791j 0.9319+0.3665j
line_671_680 0.0000-0.0000j  0.0000+0.0000j 0.0000+0.0000j
line_632_633 0.1588+0.1098j  0.1199+0.0903j 0.1187+0.0891j
line_633_634 0.1584+0.1092j  0.1198+0.0900j 0.1184+0.0888j
line_632_645 0.0000-0.0000j  0.2867+0.1926j 0.1133+0.0656j
line_645_646 0.0000+0.0000j  0.1146+0.0658j 0.1133+0.0652j
line_692_675 0.4786+0.0209j  0.0685-0.1433j 0.2829+0.0491j
line_671_684 0.1266+0.0848j -0.0000+0.0000j 0.1662+0.0005j
line_684_611 0.0000-0.0000j  0.0000+0.0000j 0.1657+0.0002j
line_684_652 0.1263+0.0846j  0.0000+0.0000j 0.0000+0.0000j
line_671_692 0.5620+0.0950j  0.0685-0.1433j 0.3656+0.1226j 

DSS results
                           A              B              C
line_sbs_650  1.2178+0.6411j 0.9167+0.4374j 1.2424+0.6180j
line_650_632  1.2167+0.6370j 0.9167+0.4359j 1.2404+0.6140j
line_632_670  1.0363+0.4454j 0.5116+0.1215j 0.9710+0.3812j
line_670_671  1.0159+0.4115j 0.4483+0.0819j 0.8482+0.3009j
line_671_680 -0.0000-0.0000j 0.0000-0.0000j 0.0000-0.0000j
line_632_633  0.1589+0.1098j 0.1199+0.0902j 0.1170+0.0878j
line_633_634  0.1585+0.1093j 0.1197+0.0899j 0.1167+0.0875j
line_632_645  0.0000+0.0000j 0.2866+0.1925j 0.1120+0.0648j
line_645_646  0.0000+0.0000j 0.1146+0.0658j 0.1120+0.0644j
line_692_675  0.4498+0.0083j 0.0684-0.1410j 0.2585+0.0254j
line_671_684  0.1186+0.0795j 0.0000+0.0000j 0.1511-0.0099j
line_684_611  0.0000+0.0000j 0.0000+0.0000j 0.1508-0.0101j
line_684_652  0.1184+0.0792j 0.0000+0.0000j 0.0000+0.0000j
line_671_692  0.5291+0.0788j 0.0684-0.1410j 0.3343+0.0927j


COMPARE Srx
Max |diff|:
A.(fbs - dss)   0.0791
B.(fbs - dss)   0.0069
C.(fbs - dss)   0.1406
dtype: float64
               A.(fbs - dss)   B.(fbs - dss)   C.(fbs - dss)
line_sbs_650  0.0563+0.0555j -0.0018-0.0067j  0.1055+0.0930j
line_650_632  0.0580+0.0433j -0.0002-0.0031j  0.0938+0.0744j
line_632_670  0.0586+0.0396j -0.0000-0.0027j  0.0874+0.0677j
line_670_671  0.0594+0.0322j  0.0006-0.0020j  0.0777+0.0582j
line_671_680  0.0000-0.0000j  0.0000+0.0000j -0.0000-0.0000j
line_632_633 -0.0001-0.0000j  0.0001+0.0000j  0.0017+0.0013j
line_633_634 -0.0001-0.0000j  0.0001+0.0000j  0.0016+0.0012j
line_632_645  0.0000+0.0000j  0.0002+0.0001j  0.0013+0.0008j
line_645_646  0.0000+0.0000j  0.0001+0.0000j  0.0013+0.0008j
line_692_675  0.0284+0.0121j  0.0001-0.0024j  0.0241+0.0237j
line_671_684  0.0079+0.0054j  0.0000+0.0000j  0.0150+0.0103j
line_684_611  0.0000+0.0000j  0.0000+0.0000j  0.0149+0.0102j
line_684_652  0.0078+0.0052j  0.0000+0.0000j  0.0000+0.0000j
line_671_692  0.0329+0.0162j  0.0001-0.0023j  0.0313+0.0299j 

FBS results
                          A              B              C
line_sbs_650 1.2731+0.6926j 0.9150+0.4292j 1.3459+0.7070j
line_650_632 1.2532+0.5985j 0.9179+0.4011j 1.2938+0.6082j
line_632_670 1.0912+0.4610j 0.5141+0.1171j 1.0466+0.4332j
line_670_671 1.0663+0.3957j 0.4542+0.0771j 0.9065+0.3373j
line_671_680 0.0000-0.0000j 0.0000+0.0000j 0.0000+0.0000j
line_632_633 0.1584+0.1092j 0.1198+0.0900j 0.1184+0.0888j
line_633_634 0.1580+0.1087j 0.1196+0.0897j 0.1180+0.0885j
line_632_645 0.0000+0.0000j 0.2838+0.1902j 0.1133+0.0652j
line_645_646 0.0000+0.0000j 0.1144+0.0656j 0.1132+0.0649j
line_692_675 0.4751+0.0185j 0.0682-0.1439j 0.2821+0.0492j
line_671_684 0.1263+0.0846j 0.0000+0.0000j 0.1657+0.0002j
line_684_611 0.0000+0.0000j 0.0000+0.0000j 0.1653-0.0003j
line_684_652 0.1253+0.0842j 0.0000+0.0000j 0.0000+0.0000j
line_671_692 0.5620+0.0950j 0.0685-0.1433j 0.3656+0.1226j 

DSS results
                           A               B              C
line_sbs_650  1.2167+0.6370j  0.9167+0.4359j 1.2404+0.6140j
line_650_632  1.1952+0.5552j  0.9181+0.4041j 1.2000+0.5338j
line_632_670  1.0326+0.4213j  0.5141+0.1198j 0.9592+0.3654j
line_670_671  1.0070+0.3635j  0.4536+0.0791j 0.8288+0.2791j
line_671_680 -0.0000+0.0000j -0.0000-0.0000j 0.0000+0.0000j
line_632_633  0.1585+0.1093j  0.1197+0.0899j 0.1167+0.0875j
line_633_634  0.1581+0.1087j  0.1195+0.0897j 0.1164+0.0873j
line_632_645  0.0000+0.0000j  0.2836+0.1901j 0.1120+0.0644j
line_645_646  0.0000+0.0000j  0.1143+0.0656j 0.1118+0.0642j
line_692_675  0.4467+0.0064j  0.0681-0.1415j 0.2580+0.0255j
line_671_684  0.1184+0.0792j  0.0000+0.0000j 0.1508-0.0101j
line_684_611  0.0000+0.0000j  0.0000+0.0000j 0.1504-0.0105j
line_684_652  0.1175+0.0790j  0.0000+0.0000j 0.0000+0.0000j
line_671_692  0.5291+0.0788j  0.0684-0.1410j 0.3343+0.0927j


COMPARE TOTAL NODE POWERS

Max |diff|:
A.(fbs - dss)   30.8882
B.(fbs - dss)    2.4329
C.(fbs - dss)   36.1278
dtype: float64
             A.(fbs - dss)  B.(fbs - dss)    C.(fbs - dss)
sourcebus   0.0000+0.0000j 0.0000+0.0000j   0.0000+0.0000j
671       18.5059+10.5948j 0.5694+0.2987j 31.3704+17.9198j
634        -0.0768-0.0457j 0.0728+0.0482j   1.6471+1.2332j
645         0.0000+0.0000j 0.1028+0.0666j   0.0000+0.0000j
646         0.0000+0.0000j 0.0893+0.0459j   1.3138+0.7524j
692         7.5937+6.7431j 0.0000+0.0000j   3.4173+3.0413j
675       28.3992+12.1478j 0.0930-2.4311j 24.1302+23.6847j
611         0.0000+0.0000j 0.0000+0.0000j 14.8594+10.1902j
652         7.8007+5.2482j 0.0000+0.0000j   0.0000+0.0000j
670         0.0789+0.0472j 0.0549+0.0281j   3.7270+2.1644j
650         0.0000+0.0000j 0.0000+0.0000j   0.0000+0.0000j
632         0.0000+0.0000j 0.0000+0.0000j   0.0000+0.0000j
680         0.0000+0.0000j 0.0000+0.0000j   0.0000+0.0000j
633         0.0000+0.0000j 0.0000+0.0000j   0.0000+0.0000j
684         0.0000+0.0000j 0.0000+0.0000j   0.0000+0.0000j 

FBS results
                           A                  B                  C
sourcebus     0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
671       377.7641+215.8652j 385.7417+220.4238j 374.7411+214.1378j
634       158.0389+108.6517j  119.6062+89.7047j  118.0176+88.5132j
645           0.0000+0.0000j 169.1560+124.3794j     0.0000+0.0000j
646           0.0000+0.0000j  114.3590+65.6321j  113.1544+64.9408j
692         83.4025+74.0810j     0.0000+0.0000j   82.7351+73.4882j
675        475.0926+18.5170j  68.1714-143.8849j  282.1265+49.1666j
611           0.0000+0.0000j     0.0000+0.0000j   165.2810-0.2848j
652        125.3498+84.2194j     0.0000+0.0000j     0.0000+0.0000j
670          16.7715+9.8656j   65.9257+37.9572j  114.7293+66.6803j
650           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
632           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
680           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
633           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
684           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j 

DSS results
                           A                  B                  C
sourcebus     0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
671       359.2582+205.2704j 385.1723+220.1251j 343.3708+196.2180j
634       158.1157+108.6975j  119.5334+89.6564j  116.3705+87.2800j
645           0.0000+0.0000j 169.0532+124.3128j     0.0000+0.0000j
646           0.0000+0.0000j  114.2697+65.5862j  111.8407+64.1884j
692         75.8088+67.3379j     0.0000+0.0000j   79.3178+70.4469j
675         446.6934+6.3692j  68.0784-141.4537j  257.9962+25.4819j
611           0.0000+0.0000j     0.0000+0.0000j  150.4215-10.4750j
652        117.5491+78.9711j     0.0000+0.0000j     0.0000+0.0000j
670          16.6925+9.8184j   65.8708+37.9291j  111.0023+64.5158j
650           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
632           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
680           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
633           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
684           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j


COMPARE TOTAL NODE POWERS - SUM OVER PHASE

Max |diff|:
99.76965157240944
A   62.3015+34.7354j
B     0.9821-1.9435j
C   80.4652+58.9859j
dtype: complex128 

FBS results
A   1236.4192+511.1999j
B    922.9599+394.2124j
C   1250.7850+556.6422j
dtype: complex128 

DSS results
A   1174.1177+476.4645j
B    921.9778+396.1559j
C   1170.3198+497.6562j
dtype: complex128
F

=================================== FAILURES ===================================
___________________________________ test_all ___________________________________

    def test_all():
        """
        Compare the python FBS solution to the opendss solution.
        To save output, run from command line:
        pytest ./fbs/tests/test_compare_opendss.py -s >[OUTPUT FILE PATH]
        Examples:
        $ pytest ./fbs/tests/test_compare_opendss.py -s > ./fbs/tests/06n3ph_unbal/06n3ph_out.txt
        $ pytest ./fbs/tests/test_compare_opendss.py -s > ./fbs/tests/05n3ph_unbal/05n3ph_out.txt
        """
        tolerance = 10**-1
        for file in dss_files:
            print(f'\n\nTesting File: {file}')
>           compare_fbs_sol(file, tolerance)

fbs/tests/test_compare_opendss.py:45: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

dss_file = '/Users/elainelaguerta/Dropbox/LBNL/python-powerflow/IEEE_13_Node/IEEE_13_Bus_allwye_noxfm_noreg.dss'
tolerance = 0.1

    def compare_fbs_sol(dss_file, tolerance):
        # TODO: Figure out how to get Inode (iNR) and sV (sNR) at each node from dss and perform a compare
        # solve with fbs
        network = init_from_dss(dss_file)
        fbs_sol = get_fbs_solution(fbs(network))
    
        # solve with dss
        dss_sol = solve_with_dss(dss_file)
    
        fbsV, fbsI, fbsStx, fbsSrx, fbs_sV = fbs_sol.V_df(), fbs_sol.I_df(), fbs_sol.Stx_df(), \
            fbs_sol.Srx_df(), fbs_sol.sV_df()
        dssV, dssI, dssStx, dssSrx, dssLoads, dss = dss_sol
        dssVMag = getVMag(dss)
        fbsVMag = fbs_sol.VMag_df()
        print(f"FBS iterations: {fbs_sol.iterations}\t FBS convergence:{fbs_sol.diff}\t FBS tolerance: {fbs_sol.tolerance}")
        print("\n\nCOMPARE V")
        V_maxDiff = compare_dfs(fbsV, dssV)
        print("\n\nCOMPARE VMag (LN)")
        VMag_maxDiff = compare_dfs(fbsVMag, dssVMag)
        print("\n\nCOMPARE I")
        I_maxDiff = compare_dfs(fbsI, dssI)
        print("\n\nCOMPARE Stx")
        Stx_maxDiff = compare_dfs(fbsStx, dssStx)
        print("\n\nCOMPARE Srx")
        Srx_maxDiff = compare_dfs(fbsSrx, dssSrx)
    
        print("\n\nCOMPARE TOTAL NODE POWERS\n")
        fbsLoads = fbs_sV.multiply(1000)
    
        loads_maxDiff = compare_dfs(fbsLoads, dssLoads)
    
        print("\n\nCOMPARE TOTAL NODE POWERS - SUM OVER PHASE\n")
        fbsLoads_sumPhase = fbsLoads.sum(axis = 0)
        dssLoads_sumPhase = dssLoads.sum(axis = 0)
        sumPhase_maxDiff = compare_dfs(fbsLoads_sumPhase, dssLoads_sumPhase)
    
        assert (V_maxDiff <= tolerance).all()
>       assert (VMag_maxDiff <= tolerance).all()
E       assert False
E        +  where False = <bound method Series.all of A.(fbs - dss)    False\nB.(fbs - dss)    False\nC.(fbs - dss)    False\ndtype: bool>()
E        +    where <bound method Series.all of A.(fbs - dss)    False\nB.(fbs - dss)    False\nC.(fbs - dss)    False\ndtype: bool> = A.(fbs - dss)   25.4808\nB.(fbs - dss)   18.9727\nC.(fbs - dss)   44.0834\ndtype: float64 <= 0.1.all

fbs/tests/test_compare_opendss.py:86: AssertionError
=============================== warnings summary ===============================
tests/test_compare_opendss.py::test_all
  /Users/elainelaguerta/Dropbox/LBNL/OpenDSSDirect.py/opendssdirect/utils.py:71: UserWarning: Empty list (opendssdirect.Transformers)
    warnings.warn("Empty list ({class_name})".format(class_name=class_name))

tests/test_compare_opendss.py::test_all
  /Users/elainelaguerta/Dropbox/LBNL/LinDist3Flow/fbs/fbs/solution.py:184: RuntimeWarning: invalid value encountered in true_divide
    new_line_I = np.conj(np.divide(node_s, node_V))

tests/test_compare_opendss.py::test_all
  /Users/elainelaguerta/Dropbox/LBNL/LinDist3Flow/fbs/fbs/solution.py:282: RuntimeWarning: invalid value encountered in true_divide
    node_I = np.conj(np.divide(node_sV,node_V))

-- Docs: https://docs.pytest.org/en/stable/warnings.html
=========================== short test summary info ============================
FAILED fbs/tests/test_compare_opendss.py::test_all - assert False
======================== 1 failed, 3 warnings in 1.48s =========================
