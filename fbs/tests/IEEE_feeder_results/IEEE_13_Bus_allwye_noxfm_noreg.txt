============================= test session starts ==============================
platform darwin -- Python 3.7.4, pytest-6.0.1, py-1.9.0, pluggy-0.13.1
rootdir: /Users/elainelaguerta/Dropbox/LBNL/LinDist3Flow/fbs
collected 1 item

fbs/tests/test_compare_opendss.py 

Testing File: /Users/elainelaguerta/Dropbox/LBNL/python-powerflow/IEEE_13_Node/IEEE_13_Bus_allwye_noxfm_noreg.dss

Opendss Iterations: 3	Opendss Convergence: 0.0001
FBS iterations: 12	 FBS convergence:        5.070223358506278e-10	 FBS tolerance: 1e-09
COMPARE V - SUMMARY STATS
                      A      B      C
MAX |fbs - dss|  0.0106 0.0079 0.0184
SUM |fbs - dss|  0.0851 0.0583 0.1660
MEAN |fbs - dss| 0.0057 0.0039 0.0111 

COMPARE V - ERROR, |fbs - dss|:
            A.(fbs - dss)  B.(fbs - dss)   C.(fbs - dss)
sourcebus  0.0001+0.0002j 0.0001-0.0001j -0.0002+0.0000j
671       -0.0033-0.0098j 0.0010-0.0077j  0.0126-0.0122j
634       -0.0015-0.0050j 0.0006-0.0042j  0.0068-0.0066j
645        0.0000+0.0000j 0.0005-0.0042j  0.0067-0.0065j
646        0.0000+0.0000j 0.0005-0.0042j  0.0067-0.0066j
692       -0.0033-0.0098j 0.0010-0.0077j  0.0126-0.0122j
675       -0.0039-0.0099j 0.0008-0.0079j  0.0126-0.0127j
611        0.0000+0.0000j 0.0000+0.0000j  0.0131-0.0129j
652       -0.0037-0.0096j 0.0000+0.0000j -0.0000+0.0000j
670       -0.0021-0.0066j 0.0008-0.0054j  0.0087-0.0084j
650        0.0001-0.0001j 0.0001-0.0003j  0.0001-0.0003j
632       -0.0015-0.0050j 0.0006-0.0042j  0.0067-0.0064j
680       -0.0033-0.0098j 0.0010-0.0077j  0.0126-0.0122j
633       -0.0015-0.0050j 0.0006-0.0042j  0.0067-0.0065j
684       -0.0034-0.0098j 0.0000+0.0000j  0.0128-0.0125j 

COMPARE V - FBS RESULTS
                       A               B               C
sourcebus 1.0000+0.0000j -0.5000-0.8660j -0.5000+0.8660j
671       0.9160-0.1083j -0.5365-0.8530j -0.3844+0.8010j
634       0.9484-0.0549j -0.5186-0.8396j -0.4280+0.8280j
645       0.0000+0.0000j -0.5144-0.8341j -0.4278+0.8325j
646       0.0000+0.0000j -0.5131-0.8320j -0.4261+0.8312j
692       0.9160-0.1083j -0.5365-0.8530j -0.3844+0.8010j
675       0.9086-0.1117j -0.5406-0.8532j -0.3839+0.7988j
611       0.0000+0.0000j  0.0000+0.0000j -0.3786+0.7983j
652       0.9080-0.1065j  0.0000+0.0000j -0.0000+0.0000j
670       0.9423-0.0713j -0.5245-0.8461j -0.4133+0.8217j
650       0.9978-0.0025j -0.5009-0.8650j -0.4967+0.8644j
632       0.9547-0.0527j -0.5191-0.8438j -0.4307+0.8328j
680       0.9160-0.1083j -0.5365-0.8530j -0.3844+0.8010j
633       0.9516-0.0538j -0.5189-0.8417j -0.4293+0.8304j
684       0.9139-0.1086j  0.0000+0.0000j -0.3818+0.7995j 

COMPARE V - DSS RESULTS
                       A               B               C
sourcebus 0.9999-0.0002j -0.5001-0.8659j -0.4998+0.8660j
671       0.9193-0.0985j -0.5375-0.8452j -0.3970+0.8131j
634       0.9499-0.0498j -0.5192-0.8354j -0.4347+0.8346j
645       0.0000+0.0000j -0.5150-0.8299j -0.4344+0.8390j
646       0.0000+0.0000j -0.5137-0.8278j -0.4327+0.8378j
692       0.9193-0.0985j -0.5375-0.8452j -0.3970+0.8131j
675       0.9125-0.1019j -0.5413-0.8453j -0.3965+0.8115j
611       0.0000+0.0000j  0.0000+0.0000j -0.3916+0.8112j
652       0.9118-0.0969j  0.0000+0.0000j  0.0000+0.0000j
670       0.9444-0.0647j -0.5253-0.8407j -0.4220+0.8301j
650       0.9978-0.0024j -0.5010-0.8646j -0.4968+0.8647j
632       0.9563-0.0477j -0.5197-0.8396j -0.4373+0.8392j
680       0.9193-0.0985j -0.5375-0.8452j -0.3970+0.8131j
633       0.9531-0.0488j -0.5195-0.8375j -0.4360+0.8369j
684       0.9173-0.0988j  0.0000+0.0000j -0.3947+0.8120j 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 

COMPARE VMag - SUMMARY STATS
                      A      B      C
MAX |fbs - dss|  0.0027 0.0062 0.0173
SUM |fbs - dss|  0.0196 0.0450 0.1565
MEAN |fbs - dss| 0.0013 0.0030 0.0104 

COMPARE VMag - ERROR, |fbs - dss|:
           A.(fbs - dss)  B.(fbs - dss)  C.(fbs - dss)
sourcebus         0.0001         0.0001         0.0001
671              -0.0022         0.0060        -0.0164
634              -0.0012         0.0033        -0.0089
645               0.0000         0.0033        -0.0089
646               0.0000         0.0033        -0.0089
692              -0.0022         0.0060        -0.0164
675              -0.0027         0.0062        -0.0169
611               0.0000         0.0000        -0.0173
652              -0.0026         0.0000         0.0000
670              -0.0016         0.0042        -0.0114
650               0.0001         0.0003        -0.0003
632              -0.0013         0.0032        -0.0088
680              -0.0022         0.0060        -0.0164
633              -0.0012         0.0032        -0.0088
684              -0.0023         0.0000        -0.0168 

COMPARE VMag - FBS RESULTS
               A      B      C
sourcebus 1.0000 1.0000 1.0000
671       0.9224 1.0077 0.8884
634       0.9500 0.9868 0.9321
645       0.0000 0.9800 0.9360
646       0.0000 0.9775 0.9341
692       0.9224 1.0077 0.8884
675       0.9154 1.0100 0.8862
611       0.0000 0.0000 0.8835
652       0.9142 0.0000 0.0000
670       0.9450 0.9955 0.9198
650       0.9978 0.9995 0.9970
632       0.9562 0.9907 0.9376
680       0.9224 1.0077 0.8884
633       0.9531 0.9887 0.9348
684       0.9203 0.0000 0.8860 

COMPARE VMag - DSS RESULTS
               A      B      C
sourcebus 0.9999 0.9999 0.9999
671       0.9246 1.0017 0.9049
634       0.9512 0.9836 0.9410
645       0.0000 0.9767 0.9448
646       0.0000 0.9742 0.9430
692       0.9246 1.0017 0.9049
675       0.9182 1.0038 0.9031
611       0.0000 0.0000 0.9008
652       0.9169 0.0000 0.0000
670       0.9466 0.9913 0.9312
650       0.9978 0.9993 0.9973
632       0.9574 0.9875 0.9464
680       0.9246 1.0017 0.9049
633       0.9543 0.9855 0.9437
684       0.9226 0.0000 0.9028 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 

COMPARE I - SUMMARY STATS
                      A      B      C
MAX |fbs - dss|  0.0792 0.0073 0.1414
SUM |fbs - dss|  0.4211 0.0321 0.7066
MEAN |fbs - dss| 0.0301 0.0023 0.0505 

COMPARE I - ERROR, |fbs - dss|:
               A.(fbs - dss)   B.(fbs - dss)  C.(fbs - dss)
line_sbs_650  0.0562-0.0559j  0.0070-0.0019j 0.0281+0.1386j
line_650_632  0.0562-0.0559j  0.0070-0.0019j 0.0281+0.1386j
line_632_670  0.0567-0.0549j  0.0052-0.0012j 0.0264+0.1321j
line_670_671  0.0567-0.0547j  0.0049-0.0011j 0.0254+0.1258j
line_671_680 -0.0000-0.0000j -0.0000+0.0000j 0.0000+0.0000j
line_632_633 -0.0005-0.0010j  0.0005-0.0002j 0.0011+0.0036j
line_633_634 -0.0005-0.0010j  0.0005-0.0002j 0.0011+0.0036j
line_632_645  0.0000+0.0000j  0.0013-0.0005j 0.0006+0.0029j
line_645_646  0.0000+0.0000j  0.0005-0.0002j 0.0006+0.0029j
line_692_675  0.0299-0.0226j  0.0021-0.0001j 0.0122+0.0419j
line_671_684  0.0071-0.0083j  0.0000+0.0000j 0.0026+0.0236j
line_684_611  0.0000+0.0000j  0.0000+0.0000j 0.0026+0.0236j
line_684_652  0.0071-0.0083j  0.0000+0.0000j 0.0000+0.0000j
line_671_692  0.0331-0.0281j  0.0021-0.0001j 0.0164+0.0538j 

COMPARE I - FBS RESULTS
                          A               B               C
line_sbs_650 1.2741-0.6973j -0.8303-0.5770j -0.0577+1.5238j
line_650_632 1.2741-0.6973j -0.8303-0.5770j -0.0577+1.5238j
line_632_670 1.1146-0.5735j -0.3721-0.3770j -0.0905+1.2282j
line_670_671 1.0977-0.5617j -0.3048-0.3408j -0.0993+1.0842j
line_671_680 0.0000+0.0000j -0.0000+0.0000j  0.0000+0.0000j
line_632_633 0.1595-0.1238j -0.1410-0.0554j  0.0262+0.1561j
line_633_634 0.1595-0.1238j -0.1410-0.0554j  0.0262+0.1561j
line_632_645 0.0000+0.0000j -0.3172-0.1446j  0.0066+0.1395j
line_645_646 0.0000+0.0000j -0.1186-0.0643j  0.0066+0.1395j
line_692_675 0.5126-0.0834j  0.0842-0.1333j -0.0879+0.3110j
line_671_684 0.1254-0.1075j  0.0000+0.0000j -0.0804+0.1689j
line_684_611 0.0000+0.0000j  0.0000+0.0000j -0.0804+0.1689j
line_684_652 0.1254-0.1075j  0.0000+0.0000j  0.0000+0.0000j
line_671_692 0.5930-0.1738j  0.0842-0.1333j -0.0536+0.4307j 

COMPARE I - DSS RESULTS
                          A               B               C
line_sbs_650 1.2179-0.6414j -0.8373-0.5751j -0.0858+1.3852j
line_650_632 1.2179-0.6414j -0.8373-0.5751j -0.0858+1.3852j
line_632_670 1.0579-0.5186j -0.3773-0.3758j -0.1170+1.0960j
line_670_671 1.0410-0.5070j -0.3096-0.3397j -0.1247+0.9584j
line_671_680 0.0000+0.0000j  0.0000-0.0000j -0.0000-0.0000j
line_632_633 0.1600-0.1228j -0.1416-0.0551j  0.0251+0.1525j
line_633_634 0.1600-0.1228j -0.1416-0.0551j  0.0251+0.1525j
line_632_645 0.0000+0.0000j -0.3185-0.1442j  0.0060+0.1366j
line_645_646 0.0000+0.0000j -0.1190-0.0642j  0.0060+0.1366j
line_692_675 0.4827-0.0608j  0.0822-0.1332j -0.1001+0.2690j
line_671_684 0.1184-0.0991j  0.0000+0.0000j -0.0831+0.1453j
line_684_611 0.0000+0.0000j  0.0000+0.0000j -0.0831+0.1453j
line_684_652 0.1184-0.0991j  0.0000+0.0000j  0.0000+0.0000j
line_671_692 0.5599-0.1457j  0.0822-0.1332j -0.0700+0.3769j 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 

COMPARE Stx - SUMMARY STATS
                      A      B      C
MAX |fbs - dss|  0.0795 0.0071 0.1416
SUM |fbs - dss|  0.3892 0.0251 0.6257
MEAN |fbs - dss| 0.0278 0.0018 0.0447 

COMPARE Stx - ERROR, |fbs - dss|:
               A.(fbs - dss)   B.(fbs - dss)   C.(fbs - dss)
line_sbs_650  0.0563+0.0561j -0.0018-0.0069j  0.1060+0.0939j
line_650_632  0.0563+0.0555j -0.0018-0.0067j  0.1055+0.0930j
line_632_670  0.0580+0.0433j -0.0004-0.0032j  0.0908+0.0724j
line_670_671  0.0585+0.0396j -0.0001-0.0028j  0.0837+0.0656j
line_671_680  0.0000+0.0000j -0.0000+0.0000j -0.0000+0.0000j
line_632_633 -0.0001-0.0000j  0.0001+0.0000j  0.0017+0.0013j
line_633_634 -0.0001-0.0000j  0.0001+0.0000j  0.0017+0.0013j
line_632_645  0.0000-0.0000j  0.0001+0.0001j  0.0013+0.0008j
line_645_646  0.0000+0.0000j  0.0001+0.0000j  0.0013+0.0008j
line_692_675  0.0288+0.0126j  0.0001-0.0023j  0.0244+0.0238j
line_671_684  0.0079+0.0054j -0.0000+0.0000j  0.0151+0.0104j
line_684_611  0.0000-0.0000j  0.0000+0.0000j  0.0150+0.0103j
line_684_652  0.0079+0.0054j  0.0000+0.0000j  0.0000+0.0000j
line_671_692  0.0329+0.0162j  0.0001-0.0023j  0.0313+0.0299j 

COMPARE Stx - FBS RESULTS
                          A               B              C
line_sbs_650 1.2741+0.6973j  0.9148+0.4306j 1.3485+0.7119j
line_650_632 1.2731+0.6926j  0.9150+0.4292j 1.3459+0.7070j
line_632_670 1.0944+0.4887j  0.5113+0.1182j 1.0618+0.4536j
line_670_671 1.0744+0.4511j  0.4482+0.0791j 0.9319+0.3665j
line_671_680 0.0000-0.0000j  0.0000+0.0000j 0.0000+0.0000j
line_632_633 0.1588+0.1098j  0.1199+0.0903j 0.1187+0.0891j
line_633_634 0.1584+0.1092j  0.1198+0.0900j 0.1184+0.0888j
line_632_645 0.0000-0.0000j  0.2867+0.1926j 0.1133+0.0656j
line_645_646 0.0000+0.0000j  0.1146+0.0658j 0.1133+0.0652j
line_692_675 0.4786+0.0209j  0.0685-0.1433j 0.2829+0.0491j
line_671_684 0.1266+0.0848j -0.0000+0.0000j 0.1662+0.0005j
line_684_611 0.0000-0.0000j  0.0000+0.0000j 0.1657+0.0002j
line_684_652 0.1263+0.0846j  0.0000+0.0000j 0.0000+0.0000j
line_671_692 0.5620+0.0950j  0.0685-0.1433j 0.3656+0.1226j 

COMPARE Stx - DSS RESULTS
                           A              B              C
line_sbs_650  1.2178+0.6411j 0.9167+0.4374j 1.2424+0.6180j
line_650_632  1.2167+0.6370j 0.9167+0.4359j 1.2404+0.6140j
line_632_670  1.0363+0.4454j 0.5116+0.1215j 0.9710+0.3812j
line_670_671  1.0159+0.4115j 0.4483+0.0819j 0.8482+0.3009j
line_671_680 -0.0000-0.0000j 0.0000-0.0000j 0.0000-0.0000j
line_632_633  0.1589+0.1098j 0.1199+0.0902j 0.1170+0.0878j
line_633_634  0.1585+0.1093j 0.1197+0.0899j 0.1167+0.0875j
line_632_645  0.0000+0.0000j 0.2866+0.1925j 0.1120+0.0648j
line_645_646  0.0000+0.0000j 0.1146+0.0658j 0.1120+0.0644j
line_692_675  0.4498+0.0083j 0.0684-0.1410j 0.2585+0.0254j
line_671_684  0.1186+0.0795j 0.0000+0.0000j 0.1511-0.0099j
line_684_611  0.0000+0.0000j 0.0000+0.0000j 0.1508-0.0101j
line_684_652  0.1184+0.0792j 0.0000+0.0000j 0.0000+0.0000j
line_671_692  0.5291+0.0788j 0.0684-0.1410j 0.3343+0.0927j 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 

COMPARE Srx - SUMMARY STATS
                      A      B      C
MAX |fbs - dss|  0.0791 0.0069 0.1406
SUM |fbs - dss|  0.3765 0.0201 0.5885
MEAN |fbs - dss| 0.0269 0.0014 0.0420 

COMPARE Srx - ERROR, |fbs - dss|:
               A.(fbs - dss)   B.(fbs - dss)   C.(fbs - dss)
line_sbs_650  0.0563+0.0555j -0.0018-0.0067j  0.1055+0.0930j
line_650_632  0.0580+0.0433j -0.0002-0.0031j  0.0938+0.0744j
line_632_670  0.0586+0.0396j -0.0000-0.0027j  0.0874+0.0677j
line_670_671  0.0594+0.0322j  0.0006-0.0020j  0.0777+0.0582j
line_671_680  0.0000-0.0000j  0.0000+0.0000j -0.0000-0.0000j
line_632_633 -0.0001-0.0000j  0.0001+0.0000j  0.0017+0.0013j
line_633_634 -0.0001-0.0000j  0.0001+0.0000j  0.0016+0.0012j
line_632_645  0.0000+0.0000j  0.0002+0.0001j  0.0013+0.0008j
line_645_646  0.0000+0.0000j  0.0001+0.0000j  0.0013+0.0008j
line_692_675  0.0284+0.0121j  0.0001-0.0024j  0.0241+0.0237j
line_671_684  0.0079+0.0054j  0.0000+0.0000j  0.0150+0.0103j
line_684_611  0.0000+0.0000j  0.0000+0.0000j  0.0149+0.0102j
line_684_652  0.0078+0.0052j  0.0000+0.0000j  0.0000+0.0000j
line_671_692  0.0329+0.0162j  0.0001-0.0023j  0.0313+0.0299j 

COMPARE Srx - FBS RESULTS
                          A              B              C
line_sbs_650 1.2731+0.6926j 0.9150+0.4292j 1.3459+0.7070j
line_650_632 1.2532+0.5985j 0.9179+0.4011j 1.2938+0.6082j
line_632_670 1.0912+0.4610j 0.5141+0.1171j 1.0466+0.4332j
line_670_671 1.0663+0.3957j 0.4542+0.0771j 0.9065+0.3373j
line_671_680 0.0000-0.0000j 0.0000+0.0000j 0.0000+0.0000j
line_632_633 0.1584+0.1092j 0.1198+0.0900j 0.1184+0.0888j
line_633_634 0.1580+0.1087j 0.1196+0.0897j 0.1180+0.0885j
line_632_645 0.0000+0.0000j 0.2838+0.1902j 0.1133+0.0652j
line_645_646 0.0000+0.0000j 0.1144+0.0656j 0.1132+0.0649j
line_692_675 0.4751+0.0185j 0.0682-0.1439j 0.2821+0.0492j
line_671_684 0.1263+0.0846j 0.0000+0.0000j 0.1657+0.0002j
line_684_611 0.0000+0.0000j 0.0000+0.0000j 0.1653-0.0003j
line_684_652 0.1253+0.0842j 0.0000+0.0000j 0.0000+0.0000j
line_671_692 0.5620+0.0950j 0.0685-0.1433j 0.3656+0.1226j 

COMPARE Srx - DSS RESULTS
                           A               B              C
line_sbs_650  1.2167+0.6370j  0.9167+0.4359j 1.2404+0.6140j
line_650_632  1.1952+0.5552j  0.9181+0.4041j 1.2000+0.5338j
line_632_670  1.0326+0.4213j  0.5141+0.1198j 0.9592+0.3654j
line_670_671  1.0070+0.3635j  0.4536+0.0791j 0.8288+0.2791j
line_671_680 -0.0000+0.0000j -0.0000-0.0000j 0.0000+0.0000j
line_632_633  0.1585+0.1093j  0.1197+0.0899j 0.1167+0.0875j
line_633_634  0.1581+0.1087j  0.1195+0.0897j 0.1164+0.0873j
line_632_645  0.0000+0.0000j  0.2836+0.1901j 0.1120+0.0644j
line_645_646  0.0000+0.0000j  0.1143+0.0656j 0.1118+0.0642j
line_692_675  0.4467+0.0064j  0.0681-0.1415j 0.2580+0.0255j
line_671_684  0.1184+0.0792j  0.0000+0.0000j 0.1508-0.0101j
line_684_611  0.0000+0.0000j  0.0000+0.0000j 0.1504-0.0105j
line_684_652  0.1175+0.0790j  0.0000+0.0000j 0.0000+0.0000j
line_671_692  0.5291+0.0788j  0.0684-0.1410j 0.3343+0.0927j 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 

TOTAL NOMINAL NODE POWERS (kW/kVAR) - SUMMARY STATS
                      A      B      C
MAX |fbs - dss|  0.0000 0.0000 0.0000
SUM |fbs - dss|  0.0000 0.0000 0.0000
MEAN |fbs - dss| 0.0000 0.0000 0.0000 

TOTAL NOMINAL NODE POWERS (kW/kVAR) - ERROR, |fbs - dss|:
           A.(fbs - dss)  B.(fbs - dss)  C.(fbs - dss)
sourcebus 0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
671       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
634       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
645       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
646       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
692       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
675       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
611       0.0000+0.0000j 0.0000+0.0000j 0.0000-0.0000j
652       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
670       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
650       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
632       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
680       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
633       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
684       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j 

TOTAL NOMINAL NODE POWERS (kW/kVAR) - FBS RESULTS
                           A                  B                  C
sourcebus     0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
671       385.0000+220.0000j 385.0000+220.0000j 385.0000+220.0000j
634       160.0000+110.0000j  120.0000+90.0000j  120.0000+90.0000j
645           0.0000+0.0000j 170.0000+125.0000j     0.0000+0.0000j
646           0.0000+0.0000j  115.0000+66.0000j  115.0000+66.0000j
692         85.0000+75.5000j     0.0000+0.0000j   85.0000+75.5000j
675        485.0000-10.0000j  68.0000-140.0000j  290.0000+12.0000j
611           0.0000+0.0000j     0.0000+0.0000j  170.0000-20.0000j
652        128.0000+86.0000j     0.0000+0.0000j     0.0000+0.0000j
670         17.0000+10.0000j   66.0000+38.0000j  117.0000+68.0000j
650           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
632           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
680           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
633           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
684           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j 

TOTAL NOMINAL NODE POWERS (kW/kVAR) - DSS RESULTS
                           A                  B                  C
sourcebus     0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
671       385.0000+220.0000j 385.0000+220.0000j 385.0000+220.0000j
634       160.0000+110.0000j  120.0000+90.0000j  120.0000+90.0000j
645           0.0000+0.0000j 170.0000+125.0000j     0.0000+0.0000j
646           0.0000+0.0000j  115.0000+66.0000j  115.0000+66.0000j
692         85.0000+75.5000j     0.0000+0.0000j   85.0000+75.5000j
675        485.0000-10.0000j  68.0000-140.0000j  290.0000+12.0000j
611           0.0000+0.0000j     0.0000+0.0000j  170.0000-20.0000j
652        128.0000+86.0000j     0.0000+0.0000j     0.0000+0.0000j
670         17.0000+10.0000j   66.0000+38.0000j  117.0000+68.0000j
650           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
632           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
680           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
633           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
684           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 

Total node power comparison, from dss.CktElement.Powers()
TOTAL NODE POWERS (kW/kVAR) - SUMMARY STATS
                       A      B        C
MAX |fbs - dss|  30.8882 2.4329  36.1278
SUM |fbs - dss|  71.9509 3.4478 100.4134
MEAN |fbs - dss|  4.7967 0.2299   6.6942 

TOTAL NODE POWERS (kW/kVAR) - ERROR, |fbs - dss|:
             A.(fbs - dss)  B.(fbs - dss)    C.(fbs - dss)
sourcebus   0.0000+0.0000j 0.0000+0.0000j   0.0000+0.0000j
671       18.5059+10.5948j 0.5694+0.2987j 31.3704+17.9198j
634        -0.0768-0.0457j 0.0728+0.0482j   1.6471+1.2332j
645         0.0000+0.0000j 0.1028+0.0666j   0.0000+0.0000j
646         0.0000+0.0000j 0.0893+0.0459j   1.3138+0.7524j
692         7.5937+6.7431j 0.0000+0.0000j   3.4173+3.0413j
675       28.3992+12.1478j 0.0930-2.4311j 24.1302+23.6847j
611         0.0000+0.0000j 0.0000+0.0000j 14.8594+10.1902j
652         7.8007+5.2482j 0.0000+0.0000j   0.0000+0.0000j
670         0.0789+0.0472j 0.0549+0.0281j   3.7270+2.1644j
650         0.0000+0.0000j 0.0000+0.0000j   0.0000+0.0000j
632         0.0000+0.0000j 0.0000+0.0000j   0.0000+0.0000j
680         0.0000+0.0000j 0.0000+0.0000j   0.0000+0.0000j
633         0.0000+0.0000j 0.0000+0.0000j   0.0000+0.0000j
684         0.0000+0.0000j 0.0000+0.0000j   0.0000+0.0000j 

TOTAL NODE POWERS (kW/kVAR) - FBS RESULTS
                           A                  B                  C
sourcebus     0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
671       377.7641+215.8652j 385.7417+220.4238j 374.7411+214.1378j
634       158.0389+108.6517j  119.6062+89.7047j  118.0176+88.5132j
645           0.0000+0.0000j 169.1560+124.3794j     0.0000+0.0000j
646           0.0000+0.0000j  114.3590+65.6321j  113.1544+64.9408j
692         83.4025+74.0810j     0.0000+0.0000j   82.7351+73.4882j
675        475.0926+18.5170j  68.1714-143.8849j  282.1265+49.1666j
611           0.0000+0.0000j     0.0000+0.0000j   165.2810-0.2848j
652        125.3498+84.2194j     0.0000+0.0000j     0.0000+0.0000j
670          16.7715+9.8656j   65.9257+37.9572j  114.7293+66.6803j
650           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
632           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
680           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
633           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
684           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j 

TOTAL NODE POWERS (kW/kVAR) - DSS RESULTS
                           A                  B                  C
sourcebus     0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
671       359.2582+205.2704j 385.1723+220.1251j 343.3708+196.2180j
634       158.1157+108.6975j  119.5334+89.6564j  116.3705+87.2800j
645           0.0000+0.0000j 169.0532+124.3128j     0.0000+0.0000j
646           0.0000+0.0000j  114.2697+65.5862j  111.8407+64.1884j
692         75.8088+67.3379j     0.0000+0.0000j   79.3178+70.4469j
675         446.6934+6.3692j  68.0784-141.4537j  257.9962+25.4819j
611           0.0000+0.0000j     0.0000+0.0000j  150.4215-10.4750j
652        117.5491+78.9711j     0.0000+0.0000j     0.0000+0.0000j
670          16.6925+9.8184j   65.8708+37.9291j  111.0023+64.5158j
650           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
632           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
680           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
633           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
684           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 

Total node power comparison, from dss.CktElement.Powers()
TOTAL NODE POWERS(pu) - SUMMARY STATS
                      A      B      C
MAX |fbs - dss|  0.0309 0.0024 0.0361
SUM |fbs - dss|  0.0720 0.0034 0.1004
MEAN |fbs - dss| 0.0048 0.0002 0.0067 

TOTAL NODE POWERS(pu) - ERROR, |fbs - dss|:
            A.(fbs - dss)  B.(fbs - dss)  C.(fbs - dss)
sourcebus  0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
671        0.0185+0.0106j 0.0006+0.0003j 0.0314+0.0179j
634       -0.0001-0.0000j 0.0001+0.0000j 0.0016+0.0012j
645        0.0000+0.0000j 0.0001+0.0001j 0.0000+0.0000j
646        0.0000+0.0000j 0.0001+0.0000j 0.0013+0.0008j
692        0.0076+0.0067j 0.0000+0.0000j 0.0034+0.0030j
675        0.0284+0.0121j 0.0001-0.0024j 0.0241+0.0237j
611        0.0000+0.0000j 0.0000+0.0000j 0.0149+0.0102j
652        0.0078+0.0052j 0.0000+0.0000j 0.0000+0.0000j
670        0.0001+0.0000j 0.0001+0.0000j 0.0037+0.0022j
650        0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
632        0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
680        0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
633        0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
684        0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j 

TOTAL NODE POWERS(pu) - FBS RESULTS
                       A              B              C
sourcebus 0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
671       0.3778+0.2159j 0.3857+0.2204j 0.3747+0.2141j
634       0.1580+0.1087j 0.1196+0.0897j 0.1180+0.0885j
645       0.0000+0.0000j 0.1692+0.1244j 0.0000+0.0000j
646       0.0000+0.0000j 0.1144+0.0656j 0.1132+0.0649j
692       0.0834+0.0741j 0.0000+0.0000j 0.0827+0.0735j
675       0.4751+0.0185j 0.0682-0.1439j 0.2821+0.0492j
611       0.0000+0.0000j 0.0000+0.0000j 0.1653-0.0003j
652       0.1253+0.0842j 0.0000+0.0000j 0.0000+0.0000j
670       0.0168+0.0099j 0.0659+0.0380j 0.1147+0.0667j
650       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
632       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
680       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
633       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
684       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j 

TOTAL NODE POWERS(pu) - DSS RESULTS
                       A              B              C
sourcebus 0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
671       0.3593+0.2053j 0.3852+0.2201j 0.3434+0.1962j
634       0.1581+0.1087j 0.1195+0.0897j 0.1164+0.0873j
645       0.0000+0.0000j 0.1691+0.1243j 0.0000+0.0000j
646       0.0000+0.0000j 0.1143+0.0656j 0.1118+0.0642j
692       0.0758+0.0673j 0.0000+0.0000j 0.0793+0.0704j
675       0.4467+0.0064j 0.0681-0.1415j 0.2580+0.0255j
611       0.0000+0.0000j 0.0000+0.0000j 0.1504-0.0105j
652       0.1175+0.0790j 0.0000+0.0000j 0.0000+0.0000j
670       0.0167+0.0098j 0.0659+0.0379j 0.1110+0.0645j
650       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
632       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
680       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
633       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
684       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 

Total node power comparison, from opendss voltage solution
TOTAL NODE POWERS (kW/kVAR) - SUMMARY STATS
                      A      B       C
MAX |fbs - dss|  0.9323 2.4153  5.3487
SUM |fbs - dss|  1.3744 3.5574 11.2552
MEAN |fbs - dss| 0.0916 0.2372  0.7503 

TOTAL NODE POWERS (kW/kVAR) - ERROR, |fbs - dss|:
            A.(fbs - dss)  B.(fbs - dss)   C.(fbs - dss)
sourcebus  0.0000+0.0000j 0.0000+0.0000j  0.0000+0.0000j
671       -0.1952-0.1115j 0.5797+0.3312j -1.4512-0.8293j
634       -0.0470-0.0323j 0.0964+0.0723j -0.2542-0.1906j
645        0.0000+0.0000j 0.1361+0.1001j  0.0000+0.0000j
646        0.0000+0.0000j 0.0921+0.0529j -0.2437-0.1398j
692       -0.0431-0.0383j 0.0000+0.0000j -0.3204-0.2846j
675       -0.3088+0.8796j 0.1064-2.4130j -1.1224+5.2296j
611        0.0000+0.0000j 0.0000+0.0000j -0.6703+2.7644j
652       -0.0790-0.0531j 0.0000+0.0000j  0.0000+0.0000j
670       -0.0065-0.0038j 0.0684+0.0394j -0.3143-0.1826j
650        0.0000+0.0000j 0.0000+0.0000j  0.0000+0.0000j
632        0.0000+0.0000j 0.0000+0.0000j  0.0000+0.0000j
680        0.0000+0.0000j 0.0000+0.0000j  0.0000+0.0000j
633        0.0000+0.0000j 0.0000+0.0000j  0.0000+0.0000j
684        0.0000+0.0000j 0.0000+0.0000j  0.0000+0.0000j 

TOTAL NODE POWERS (kW/kVAR) - FBS RESULTS
                           A                  B                  C
sourcebus     0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
671       377.7641+215.8652j 385.7417+220.4238j 374.7411+214.1378j
634       158.0389+108.6517j  119.6062+89.7047j  118.0176+88.5132j
645           0.0000+0.0000j 169.1560+124.3794j     0.0000+0.0000j
646           0.0000+0.0000j  114.3590+65.6321j  113.1544+64.9408j
692         83.4025+74.0810j     0.0000+0.0000j   82.7351+73.4882j
675        475.0926+18.5170j  68.1714-143.8849j  282.1265+49.1666j
611           0.0000+0.0000j     0.0000+0.0000j   165.2810-0.2848j
652        125.3498+84.2194j     0.0000+0.0000j     0.0000+0.0000j
670          16.7715+9.8656j   65.9257+37.9572j  114.7293+66.6803j
650           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
632           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
680           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
633           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
684           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j 

TOTAL NODE POWERS (kW/kVAR) - DSS RESULTS
                           A                  B                  C
sourcebus     0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
671       377.9593+215.9767j 385.1620+220.0926j 376.1923+214.9671j
634       158.0858+108.6840j  119.5098+89.6324j  118.2718+88.7039j
645           0.0000+0.0000j 169.0199+124.2793j     0.0000+0.0000j
646           0.0000+0.0000j  114.2668+65.5792j  113.3981+65.0806j
692         83.4456+74.1193j     0.0000+0.0000j   83.0555+73.7728j
675        475.4014+17.6374j  68.0650-141.4719j  283.2489+43.9370j
611           0.0000+0.0000j     0.0000+0.0000j   165.9512-3.0491j
652        125.4288+84.2724j     0.0000+0.0000j     0.0000+0.0000j
670          16.7779+9.8694j   65.8573+37.9178j  115.0436+66.8629j
650           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
632           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
680           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
633           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j
684           0.0000+0.0000j     0.0000+0.0000j     0.0000+0.0000j 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 

Total node power comparison, from opendss voltage solution
TOTAL NODE POWERS(pu) - SUMMARY STATS
                      A      B      C
MAX |fbs - dss|  0.0000 0.0000 0.0000
SUM |fbs - dss|  0.0000 0.0000 0.0000
MEAN |fbs - dss| 0.0000 0.0000 0.0000 

TOTAL NODE POWERS(pu) - ERROR, |fbs - dss|:
            A.(fbs - dss)  B.(fbs - dss)   C.(fbs - dss)
sourcebus  0.0000+0.0000j 0.0000+0.0000j  0.0000+0.0000j
671       -0.0000-0.0000j 0.0000+0.0000j -0.0000-0.0000j
634       -0.0000-0.0000j 0.0000+0.0000j -0.0000-0.0000j
645        0.0000+0.0000j 0.0000+0.0000j  0.0000+0.0000j
646        0.0000+0.0000j 0.0000+0.0000j -0.0000-0.0000j
692       -0.0000-0.0000j 0.0000+0.0000j -0.0000-0.0000j
675       -0.0000+0.0000j 0.0000-0.0000j -0.0000+0.0000j
611        0.0000+0.0000j 0.0000+0.0000j -0.0000+0.0000j
652       -0.0000-0.0000j 0.0000+0.0000j  0.0000+0.0000j
670       -0.0000-0.0000j 0.0000+0.0000j -0.0000-0.0000j
650        0.0000+0.0000j 0.0000+0.0000j  0.0000+0.0000j
632        0.0000+0.0000j 0.0000+0.0000j  0.0000+0.0000j
680        0.0000+0.0000j 0.0000+0.0000j  0.0000+0.0000j
633        0.0000+0.0000j 0.0000+0.0000j  0.0000+0.0000j
684        0.0000+0.0000j 0.0000+0.0000j  0.0000+0.0000j 

TOTAL NODE POWERS(pu) - FBS RESULTS
                       A              B              C
sourcebus 0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
671       0.0004+0.0002j 0.0004+0.0002j 0.0004+0.0002j
634       0.0002+0.0001j 0.0001+0.0001j 0.0001+0.0001j
645       0.0000+0.0000j 0.0002+0.0001j 0.0000+0.0000j
646       0.0000+0.0000j 0.0001+0.0001j 0.0001+0.0001j
692       0.0001+0.0001j 0.0000+0.0000j 0.0001+0.0001j
675       0.0005+0.0000j 0.0001-0.0001j 0.0003+0.0000j
611       0.0000+0.0000j 0.0000+0.0000j 0.0002-0.0000j
652       0.0001+0.0001j 0.0000+0.0000j 0.0000+0.0000j
670       0.0000+0.0000j 0.0001+0.0000j 0.0001+0.0001j
650       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
632       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
680       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
633       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
684       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j 

TOTAL NODE POWERS(pu) - DSS RESULTS
                       A              B              C
sourcebus 0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
671       0.0004+0.0002j 0.0004+0.0002j 0.0004+0.0002j
634       0.0002+0.0001j 0.0001+0.0001j 0.0001+0.0001j
645       0.0000+0.0000j 0.0002+0.0001j 0.0000+0.0000j
646       0.0000+0.0000j 0.0001+0.0001j 0.0001+0.0001j
692       0.0001+0.0001j 0.0000+0.0000j 0.0001+0.0001j
675       0.0005+0.0000j 0.0001-0.0001j 0.0003+0.0000j
611       0.0000+0.0000j 0.0000+0.0000j 0.0002-0.0000j
652       0.0001+0.0001j 0.0000+0.0000j 0.0000+0.0000j
670       0.0000+0.0000j 0.0001+0.0000j 0.0001+0.0001j
650       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
632       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
680       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
633       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j
684       0.0000+0.0000j 0.0000+0.0000j 0.0000+0.0000j 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 

TOTAL NODE POWERS - SUM OVER PHASE (kW/kVAR) - ERROR, |fbs - dss|:
A   62.3015+34.7354j
B     0.9821-1.9435j
C   80.4652+58.9859j
dtype: complex128 

TOTAL NODE POWERS - SUM OVER PHASE (kW/kVAR) - FBS RESULTS
A   1236.4192+511.1999j
B    922.9599+394.2124j
C   1250.7850+556.6422j
dtype: complex128 

TOTAL NODE POWERS - SUM OVER PHASE (kW/kVAR) - DSS RESULTS
A   1174.1177+476.4645j
B    921.9778+396.1559j
C   1170.3198+497.6562j
dtype: complex128 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 

TOTAL NODE POWERS = SUM OVER PHASE (pu) - ERROR, |fbs - dss|:
A   0.0623+0.0347j
B   0.0010-0.0019j
C   0.0805+0.0590j
dtype: complex128 

TOTAL NODE POWERS = SUM OVER PHASE (pu) - FBS RESULTS
A   1.2364+0.5112j
B   0.9230+0.3942j
C   1.2508+0.5566j
dtype: complex128 

TOTAL NODE POWERS = SUM OVER PHASE (pu) - DSS RESULTS
A   1.1741+0.4765j
B   0.9220+0.3962j
C   1.1703+0.4977j
dtype: complex128 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 

F

=================================== FAILURES ===================================
___________________________________ test_all ___________________________________

    def test_all():
        """
        Compare the python FBS solution to the opendss solution.
        To save output, run from command line:
        pytest ./fbs/tests/test_compare_opendss.py -s >[OUTPUT FILE PATH]
        Examples:
        $ pytest ./fbs/tests/test_compare_opendss.py -s > ./fbs/tests/06n3ph_unbal/06n3ph_out.txt
        $ pytest ./fbs/tests/test_compare_opendss.py -s > ./fbs/tests/05n3ph_unbal/05n3ph_out.txt
        """
        tolerance = 10**-1
        for file in dss_files:
            print(f'\n\nTesting File: {file}')
>           compare_fbs_sol(file, tolerance)

fbs/tests/test_compare_opendss.py:46: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

dss_file = '/Users/elainelaguerta/Dropbox/LBNL/python-powerflow/IEEE_13_Node/IEEE_13_Bus_allwye_noxfm_noreg.dss'
tolerance = 0.1

    def compare_fbs_sol(dss_file, tolerance):
        # TODO: Figure out how to get Inode (iNR) and sV (sNR) at each node from dss and perform a compare
        # solve with fbs
        network = init_from_dss(dss_file)
        fbs_sol = get_fbs_solution(fbs(network))
    
        # solve with dss
        dss_sol = solve_with_dss(dss_file)
    
        fbsV, fbsI, fbsStx, fbsSrx, fbs_sV = fbs_sol.V_df(), fbs_sol.I_df(), fbs_sol.Stx_df(), \
            fbs_sol.Srx_df(), fbs_sol.sV_df()
        dssV, dssI, dssStx, dssSrx, dssNodePowers, dss = dss_sol
    
        print(f"FBS iterations: {fbs_sol.iterations}\t FBS convergence:\
            {fbs_sol.diff}\t FBS tolerance: {fbs_sol.tolerance}")
        V_maxDiff = compare_dfs(fbsV, dssV, "COMPARE V")
    
        dssVMag = getVMag(dss)
        fbsVMag = fbs_sol.VMag_df()
        VMag_maxDiff = compare_dfs(fbsVMag, dssVMag, "COMPARE VMag")
    
        I_maxDiff = compare_dfs(fbsI, dssI, "COMPARE I")
    
        Stx_maxDiff = compare_dfs(fbsStx, dssStx, "COMPARE Stx")
    
        Srx_maxDiff = compare_dfs(fbsSrx, dssSrx, "COMPARE Srx")
    
        fbsNomPwrs = fbs_sol.nomNodePwrs_df() * 1000  # convert to kW
        dssNomPwrs = getNominalNodePower(dss)
        compare_dfs(fbsNomPwrs, dssNomPwrs, "TOTAL NOMINAL NODE POWERS (kW/kVAR)")
    
        print("Total node power comparison, from dss.CktElement.Powers()")
        fbsNodePowers = fbs_sV * 1000  # convert to kW
        nodePowers_maxDiff1 = compare_dfs(fbsNodePowers, dssNodePowers, "TOTAL NODE POWERS (kW/kVAR)")
        print("Total node power comparison, from dss.CktElement.Powers()")
        compare_dfs(fbs_sV, dssNodePowers * 1000/network.Sbase, "TOTAL NODE POWERS(pu)")
    
        print("Total node power comparison, from opendss voltage solution")
        dssNodePowers_2 = getTotalNodePower(dss) * 1000
        nodePowers_maxDiff2 = compare_dfs(fbsNodePowers, dssNodePowers_2, "TOTAL NODE POWERS (kW/kVAR)")
        print("Total node power comparison, from opendss voltage solution")
        compare_dfs(fbsNodePowers/network.Sbase, dssNodePowers_2/network.Sbase, "TOTAL NODE POWERS(pu)")
    
        fbsNodePowers_sumPhase = fbsNodePowers.sum(axis=0)
        dssNodePowers_sumPhase = dssNodePowers.sum(axis=0)
        compare_dfs(fbsNodePowers_sumPhase, dssNodePowers_sumPhase, "TOTAL NODE POWERS - SUM OVER PHASE (kW/kVAR)")
        compare_dfs(fbs_sV.sum(axis=0), dssNodePowers_sumPhase * 1000 /
                    network.Sbase, "TOTAL NODE POWERS = SUM OVER PHASE (pu)")
    
        assert (V_maxDiff <= tolerance).all()
        assert (VMag_maxDiff <= tolerance).all()
>       assert (I_maxDiff <= tolerance).all()
E       assert False
E        +  where False = <bound method Series.all of A.(fbs - dss)     True\nB.(fbs - dss)     True\nC.(fbs - dss)    False\ndtype: bool>()
E        +    where <bound method Series.all of A.(fbs - dss)     True\nB.(fbs - dss)     True\nC.(fbs - dss)    False\ndtype: bool> = A.(fbs - dss)   0.0792\nB.(fbs - dss)   0.0073\nC.(fbs - dss)   0.1414\ndtype: float64 <= 0.1.all

fbs/tests/test_compare_opendss.py:101: AssertionError
=============================== warnings summary ===============================
tests/test_compare_opendss.py::test_all
  /Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/opendssdirect/utils.py:71: UserWarning: Empty list (opendssdirect.Transformers)
    warnings.warn("Empty list ({class_name})".format(class_name=class_name))

tests/test_compare_opendss.py::test_all
  /Users/elainelaguerta/Dropbox/LBNL/LinDist3Flow/fbs/fbs/solution.py:185: RuntimeWarning: invalid value encountered in true_divide
    new_line_I = np.conj(np.divide(node_s, node_V))

tests/test_compare_opendss.py::test_all
  /Users/elainelaguerta/Dropbox/LBNL/LinDist3Flow/fbs/fbs/solution.py:247: RuntimeWarning: invalid value encountered in true_divide
    node_I = np.conj(np.divide(node_sV,node_V))

-- Docs: https://docs.pytest.org/en/stable/warnings.html
=========================== short test summary info ============================
FAILED fbs/tests/test_compare_opendss.py::test_all - assert False
======================== 1 failed, 3 warnings in 1.91s =========================
