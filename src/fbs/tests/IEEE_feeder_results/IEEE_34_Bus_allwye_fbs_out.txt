============================= test session starts ==============================
platform darwin -- Python 3.7.4, pytest-6.0.1, py-1.9.0, pluggy-0.13.1
rootdir: /Users/elainelaguerta/Dropbox/LBNL/LinDist3Flow/fbs
collected 1 item

fbs/tests/test_compare_opendss.py 

Testing File: fbs/tests/IEEE_34_feeder_UB/IEEE_34_Bus_allwye.dss
Initial Solution Not Converged. Check Model for Convergence

Opendss Iterations: 30000	Opendss Convergence: 0.0001
Opendss Load Powers at 848: [19.24229273504248, 15.794266070605723, 19.333395056555297, 15.36429521734248, 21.009824110527717, 16.44750121798829, 0.0, 0.0]
FBS Load Powers at 848: [0.02  -0.18729474j 0.0315-0.15807174j 0.02  -0.17336878j]



FBS Capacitor powers at c844: [0.13543601 0.11970142 0.12616219]
OpenDSS Capacitor powers at c844: [0.0, -73.85955146693452, 0.0, -76.94633801133999, 0.0, -80.37505235344048, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
FBS Capacitor powers at c848: [0.20329474 0.17957174 0.18936878]
OpenDSS Capacitor powers at c848: [0.0, -110.83559116076408, 7.275957614183426e-15, -115.39174005294439, -7.275957614183426e-15, -120.61778316114689, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
FBS iterations: 9	 FBS convergence:3.1125581203111735e-10	 FBS tolerance: 1e-09


COMPARE V
Max |diff|:
A.(fbs - dss)   0.3096
B.(fbs - dss)   0.2824
C.(fbs - dss)   0.2367
dtype: float64
           A.(fbs - dss)   B.(fbs - dss)   C.(fbs - dss)
sourcebus 0.0002-0.0000j  0.0002-0.0000j  0.0002-0.0000j
800       0.0002-0.0000j  0.0002-0.0000j  0.0002-0.0000j
802       0.0023+0.0008j  0.0004-0.0017j -0.0009+0.0007j
806       0.0038+0.0014j  0.0005-0.0029j -0.0017+0.0012j
808       0.0307+0.0117j  0.0023-0.0242j -0.0157+0.0108j
810       0.0000+0.0000j  0.0023-0.0242j -0.0000+0.0000j
812       0.0622+0.0233j  0.0039-0.0490j -0.0319+0.0223j
814       0.0874+0.0323j  0.0050-0.0686j -0.0447+0.0317j
814r      0.1751+0.0326j -0.0074-0.0905j -0.0636+0.0641j
850       0.1751+0.0326j -0.0074-0.0905j -0.0636+0.0642j
816       0.1753+0.0327j -0.0075-0.0908j -0.0638+0.0643j
818       0.1755+0.0327j  0.0000+0.0000j -0.0000+0.0000j
824       0.1821+0.0345j -0.0096-0.0995j -0.0697+0.0688j
820       0.1806+0.0324j  0.0000+0.0000j -0.0000+0.0000j
822       0.1813+0.0323j  0.0000+0.0000j -0.0000+0.0000j
826       0.0000+0.0000j -0.0096-0.0995j -0.0000+0.0000j
828       0.1827+0.0346j -0.0098-0.1002j -0.0702+0.0692j
830       0.1963+0.0381j -0.0141-0.1175j -0.0819+0.0783j
854       0.1966+0.0382j -0.0142-0.1180j -0.0822+0.0785j
832       0.3024+0.0443j -0.0609-0.2159j -0.1486+0.1735j
858       0.3037+0.0436j -0.0617-0.2161j -0.1486+0.1751j
834       0.3053+0.0426j -0.0626-0.2164j -0.1486+0.1769j
860       0.3054+0.0426j -0.0626-0.2164j -0.1487+0.1771j
842       0.3053+0.0426j -0.0626-0.2164j -0.1486+0.1770j
836       0.3055+0.0426j -0.0627-0.2164j -0.1487+0.1771j
840       0.3055+0.0426j -0.0627-0.2164j -0.1487+0.1771j
862       0.3055+0.0426j -0.0627-0.2164j -0.1487+0.1771j
844       0.3056+0.0424j -0.0628-0.2164j -0.1486+0.1773j
846       0.3058+0.0421j -0.0630-0.2165j -0.1485+0.1775j
848       0.3059+0.0421j -0.0631-0.2165j -0.1485+0.1776j
852r      0.3024+0.0443j -0.0609-0.2159j -0.1486+0.1735j
888       0.3054+0.0508j -0.0594-0.2575j -0.1566+0.1774j
856       0.0000+0.0000j -0.0141-0.1180j -0.0000+0.0000j
852       0.2209+0.0441j -0.0226-0.1492j -0.1031+0.0949j
864       0.3038+0.0436j  0.0000-0.0000j -0.0000+0.0000j
838       0.0000+0.0000j -0.0627-0.2164j -0.0000+0.0000j
890       0.2412+0.0254j -0.0689-0.2739j -0.1168+0.1101j 

FBS results
                       A               B               C
sourcebus 1.0000-0.0000j -0.5000-0.8660j -0.5000+0.8660j
800       1.0000-0.0000j -0.5000-0.8660j -0.5000+0.8660j
802       1.0000+0.0001j -0.4999-0.8658j -0.4999+0.8660j
806       1.0000+0.0001j -0.4999-0.8657j -0.4999+0.8660j
808       0.9999+0.0004j -0.4997-0.8647j -0.4999+0.8663j
810       0.0000+0.0000j -0.4996-0.8646j -0.0000+0.0000j
812       0.9999+0.0004j -0.4997-0.8647j -0.4999+0.8663j
814       0.9999+0.0004j -0.4997-0.8647j -0.4999+0.8663j
814r      1.0874+0.0004j -0.5122-0.8863j -0.5187+0.8987j
850       1.0874+0.0004j -0.5122-0.8863j -0.5187+0.8987j
816       1.0873+0.0004j -0.5122-0.8863j -0.5187+0.8987j
818       1.0864+0.0004j  0.0000+0.0000j -0.0000+0.0000j
824       1.0868+0.0006j -0.5117-0.8852j -0.5185+0.8985j
820       1.0639+0.0002j  0.0000+0.0000j -0.0000+0.0000j
822       1.0610+0.0001j  0.0000+0.0000j -0.0000+0.0000j
826       0.0000+0.0000j -0.5116-0.8851j -0.0000+0.0000j
828       1.0868+0.0006j -0.5117-0.8852j -0.5185+0.8985j
830       1.0860+0.0006j -0.5115-0.8848j -0.5181+0.8979j
854       1.0860+0.0006j -0.5115-0.8848j -0.5181+0.8979j
832       1.1675+0.0006j -0.5499-0.9512j -0.5634+0.9765j
858       1.1658-0.0012j -0.5503-0.9486j -0.5609+0.9758j
834       1.1639-0.0033j -0.5508-0.9457j -0.5578+0.9751j
860       1.1635-0.0032j -0.5506-0.9453j -0.5577+0.9748j
842       1.1639-0.0034j -0.5509-0.9456j -0.5577+0.9751j
836       1.1633-0.0031j -0.5505-0.9450j -0.5576+0.9747j
840       1.1633-0.0031j -0.5505-0.9450j -0.5576+0.9747j
862       1.1633-0.0031j -0.5505-0.9450j -0.5576+0.9747j
844       1.1638-0.0039j -0.5512-0.9451j -0.5572+0.9753j
846       1.1641-0.0048j -0.5519-0.9447j -0.5565+0.9761j
848       1.1642-0.0049j -0.5520-0.9447j -0.5564+0.9762j
852r      1.1675+0.0006j -0.5499-0.9512j -0.5634+0.9765j
888       1.1675+0.0006j -0.5499-0.9512j -0.5634+0.9765j
856       0.0000+0.0000j -0.5114-0.8847j -0.0000+0.0000j
852       1.0860+0.0006j -0.5115-0.8848j -0.5181+0.8979j
864       1.1658-0.0012j  0.0000-0.0000j -0.0000+0.0000j
838       0.0000+0.0000j -0.5504-0.9449j -0.0000+0.0000j
890       1.0926-0.0069j -0.5259-0.8784j -0.5118+0.9159j 

DSS results
                       A               B               C
sourcebus 0.9998+0.0000j -0.5002-0.8660j -0.5002+0.8661j
800       0.9998+0.0000j -0.5002-0.8660j -0.5002+0.8661j
802       0.9977-0.0008j -0.5003-0.8641j -0.4990+0.8653j
806       0.9962-0.0013j -0.5004-0.8628j -0.4982+0.8648j
808       0.9693-0.0113j -0.5020-0.8405j -0.4842+0.8555j
810       0.0000+0.0000j -0.5019-0.8404j  0.0000+0.0000j
812       0.9377-0.0229j -0.5036-0.8158j -0.4680+0.8440j
814       0.9125-0.0319j -0.5047-0.7961j -0.4553+0.8346j
814r      0.9124-0.0322j -0.5048-0.7959j -0.4550+0.8346j
850       0.9123-0.0322j -0.5048-0.7958j -0.4550+0.8346j
816       0.9120-0.0323j -0.5048-0.7956j -0.4549+0.8344j
818       0.9109-0.0323j  0.0000+0.0000j  0.0000+0.0000j
824       0.9047-0.0338j -0.5021-0.7857j -0.4488+0.8297j
820       0.8833-0.0322j  0.0000+0.0000j  0.0000+0.0000j
822       0.8797-0.0321j  0.0000+0.0000j  0.0000+0.0000j
826       0.0000+0.0000j -0.5020-0.7856j  0.0000+0.0000j
828       0.9041-0.0340j -0.5019-0.7850j -0.4483+0.8293j
830       0.8897-0.0376j -0.4974-0.7673j -0.4362+0.8196j
854       0.8894-0.0377j -0.4973-0.7668j -0.4359+0.8194j
832       0.8650-0.0437j -0.4890-0.7353j -0.4148+0.8030j
858       0.8620-0.0447j -0.4886-0.7325j -0.4122+0.8007j
834       0.8586-0.0459j -0.4882-0.7293j -0.4092+0.7982j
860       0.8581-0.0458j -0.4880-0.7290j -0.4090+0.7977j
842       0.8585-0.0460j -0.4882-0.7292j -0.4091+0.7982j
836       0.8578-0.0457j -0.4878-0.7286j -0.4089+0.7976j
840       0.8578-0.0457j -0.4878-0.7286j -0.4089+0.7975j
862       0.8578-0.0457j -0.4878-0.7286j -0.4089+0.7976j
844       0.8582-0.0463j -0.4883-0.7287j -0.4086+0.7980j
846       0.8583-0.0469j -0.4889-0.7282j -0.4080+0.7985j
848       0.8583-0.0470j -0.4890-0.7281j -0.4079+0.7986j
852r      0.8650-0.0437j -0.4890-0.7353j -0.4148+0.8030j
888       0.8620-0.0502j -0.4905-0.6936j -0.4068+0.7990j
856       0.0000+0.0000j -0.4973-0.7667j  0.0000+0.0000j
852       0.8651-0.0435j -0.4889-0.7356j -0.4151+0.8030j
864       0.8620-0.0447j  0.0000+0.0000j  0.0000+0.0000j
838       0.0000+0.0000j -0.4877-0.7284j  0.0000+0.0000j
890       0.8514-0.0323j -0.4570-0.6045j -0.3950+0.8058j


COMPARE I
Max |diff|:
A.(fbs - dss)   0.6299
B.(fbs - dss)   0.5570
C.(fbs - dss)   0.4452
dtype: float64
                A.(fbs - dss)   B.(fbs - dss)   C.(fbs - dss)
creg1a            nan+0.0000j     nan-0.0000j     nan+0.0000j
creg2a            nan+0.0000j     nan-0.0000j     nan+0.0000j
line_800_802  -0.6134+0.1197j  0.3624+0.4213j  0.1832-0.4030j
line_802_806  -0.6135+0.1204j  0.3629+0.4209j  0.1827-0.4033j
line_806_808  -0.6135+0.1209j  0.3632+0.4207j  0.1824-0.4034j
line_808_810   0.0000+0.0000j -0.0007+0.0004j  0.0000+0.0000j
line_808_812  -0.6140+0.1291j  0.3699+0.4156j  0.1764-0.4073j
line_812_814  -0.6145+0.1383j  0.3768+0.4102j  0.1695-0.4116j
line_814r_850 -0.4336+0.0542j  0.3308+0.3717j  0.1613-0.3899j
line_816_818  -0.0347+0.0179j  0.0000+0.0000j  0.0000+0.0000j
line_816_824  -0.3989+0.0364j  0.3307+0.3717j  0.1613-0.3897j
line_818_820  -0.0314+0.0156j  0.0000+0.0000j  0.0000+0.0000j
line_820_822  -0.0139+0.0090j  0.0000+0.0000j  0.0000+0.0000j
line_824_826   0.0000+0.0000j  0.0011+0.0000j  0.0000+0.0000j
line_824_828  -0.3990+0.0387j  0.3298+0.3705j  0.1596-0.3903j
line_828_830  -0.3983+0.0384j  0.3299+0.3704j  0.1595-0.3900j
line_830_854  -0.3935+0.0396j  0.3325+0.3677j  0.1563-0.3888j
line_832_858  -0.0924+0.1551j  0.1147-0.0092j -0.0690-0.1520j
line_834_842  -0.0521+0.1238j  0.0941-0.0145j -0.0632-0.1018j
line_834_860  -0.0279+0.0241j  0.0186+0.0032j -0.0056-0.0345j
line_836_840  -0.0035+0.0035j  0.0036+0.0004j -0.0011-0.0052j
line_836_862   0.0000-0.0001j  0.0044+0.0013j  0.0000+0.0000j
line_842_844  -0.0509+0.1228j  0.0942-0.0145j -0.0632-0.1018j
line_844_846  -0.0113+0.0511j  0.0424-0.0079j -0.0290-0.0329j
line_846_848  -0.0114+0.0519j  0.0387-0.0092j -0.0291-0.0298j
line_850_816  -0.4336+0.0542j  0.3308+0.3717j  0.1613-0.3899j
line_852r_832  0.0170+0.0862j  0.1146-0.0272j -0.0771-0.0260j
line_854_852  -0.3935+0.0397j  0.3352+0.3658j  0.1562-0.3889j
line_854_856   0.0000+0.0000j -0.0028+0.0019j  0.0000+0.0000j
line_858_834  -0.0897+0.1543j  0.1143-0.0101j -0.0694-0.1494j
line_858_864  -0.0003-0.0000j  0.0000+0.0000j  0.0000+0.0000j
line_860_836  -0.0095+0.0077j  0.0112+0.0026j -0.0015-0.0114j
line_862_838   0.0000+0.0000j  0.0019+0.0008j  0.0000+0.0000j
line_888_890   0.1104-0.0696j -0.0005-0.0180j -0.0080+0.1267j
subxf             nan+0.0000j     nan-0.0283j     nan+0.0287j
xfm1              nan-0.0695j     nan-0.0881j     nan+0.1597j 

FBS results
                           A               B               C
line_800_802  0.0000+0.0000j -0.0430-0.0283j -0.0004+0.0287j
line_802_806  0.0000+0.0000j -0.0290-0.0191j -0.0002+0.0143j
line_806_808  0.0000+0.0000j -0.0150-0.0099j  0.0000+0.0000j
line_808_810  0.0000+0.0000j -0.0075-0.0049j  0.0000+0.0000j
line_808_812  0.0000+0.0000j  0.0000+0.0000j  0.0000+0.0000j
line_812_814  0.0000+0.0000j  0.0000+0.0000j  0.0000+0.0000j
line_814r_850 0.1813-0.0913j -0.0514-0.0341j -0.0028+0.0251j
line_816_818  0.1587-0.0817j  0.0000+0.0000j  0.0000+0.0000j
line_816_824  0.0226-0.0097j -0.0503-0.0333j -0.0026+0.0238j
line_818_820  0.1431-0.0739j  0.0000+0.0000j  0.0000+0.0000j
line_820_822  0.0636-0.0330j  0.0000+0.0000j  0.0000+0.0000j
line_824_826  0.0000+0.0000j -0.0183-0.0120j  0.0000+0.0000j
line_824_828  0.0226-0.0097j -0.0128-0.0084j -0.0023+0.0204j
line_828_830  0.0193-0.0083j -0.0128-0.0084j -0.0022+0.0182j
line_830_854  0.0000+0.0000j -0.0037-0.0024j  0.0000+0.0000j
line_832_858  0.2710+0.1093j -0.0865-0.2986j -0.2196+0.2049j
line_834_860  0.0905-0.0533j -0.0978-0.0552j  0.0019+0.1021j
line_834_842  0.1417+0.1823j  0.0290-0.2319j -0.2192+0.0544j
line_836_840  0.0116-0.0080j -0.0182-0.0095j  0.0011+0.0155j
line_836_862  0.0000+0.0000j -0.0239-0.0157j  0.0000+0.0000j
line_842_844  0.1378+0.1844j  0.0290-0.2319j -0.2192+0.0544j
line_844_846  0.0179+0.1608j  0.0901-0.1114j -0.1430-0.0508j
line_846_848  0.0179+0.1608j  0.1102-0.0977j -0.1429-0.0609j
line_850_816  0.1813-0.0913j -0.0514-0.0341j -0.0028+0.0251j
line_852r_832 0.4107+0.0385j -0.2265-0.3880j -0.2271+0.3665j
line_854_856  0.0000+0.0000j -0.0018-0.0012j  0.0000+0.0000j
line_854_852  0.0000+0.0000j  0.0000+0.0000j  0.0000+0.0000j
line_858_864  0.0009-0.0004j  0.0000+0.0000j  0.0000+0.0000j
line_858_834  0.2629+0.1134j -0.0806-0.2947j -0.2193+0.1959j
line_860_836  0.0309-0.0179j -0.0595-0.0363j  0.0005+0.0341j
line_862_838  0.0000+0.0000j -0.0120-0.0078j  0.0000+0.0000j
line_888_890  0.1368-0.0695j -0.1381-0.0881j -0.0073+0.1597j
creg1a        0.0000+0.0000j  0.0000-0.0000j -0.0000+0.0000j
creg2a        0.0000+0.0000j  0.0000-0.0000j -0.0000+0.0000j
subxf         0.0000+0.0000j -0.0430-0.0283j -0.0004+0.0287j
xfm1          0.1368-0.0695j -0.1381-0.0881j -0.0073+0.1597j 

DSS results
                            A               B               C
line_800_802   0.6134-0.1197j -0.4053-0.4496j -0.1835+0.4316j
line_802_806   0.6135-0.1204j -0.3918-0.4400j -0.1829+0.4176j
line_806_808   0.6135-0.1209j -0.3781-0.4306j -0.1824+0.4034j
line_808_810   0.0000+0.0000j -0.0068-0.0053j  0.0000+0.0000j
line_808_812   0.6140-0.1291j -0.3699-0.4156j -0.1764+0.4073j
line_812_814   0.6145-0.1383j -0.3768-0.4102j -0.1695+0.4116j
line_814r_850  0.6148-0.1455j -0.3821-0.4059j -0.1641+0.4150j
line_816_818   0.1934-0.0995j  0.0000+0.0000j  0.0000+0.0000j
line_816_824   0.4215-0.0461j -0.3811-0.4050j -0.1639+0.4135j
line_818_820   0.1744-0.0894j  0.0000+0.0000j  0.0000+0.0000j
line_820_822   0.0775-0.0420j  0.0000+0.0000j  0.0000+0.0000j
line_824_826   0.0000+0.0000j -0.0194-0.0121j  0.0000+0.0000j
line_824_828   0.4216-0.0484j -0.3426-0.3789j -0.1619+0.4107j
line_828_830   0.4176-0.0467j -0.3427-0.3788j -0.1617+0.4083j
line_830_854   0.3935-0.0396j -0.3361-0.3701j -0.1563+0.3888j
line_832_858   0.3634-0.0458j -0.2013-0.2894j -0.1506+0.3569j
line_834_860   0.1185-0.0774j -0.1163-0.0584j  0.0075+0.1366j
line_834_842   0.1938+0.0585j -0.0651-0.2174j -0.1560+0.1562j
line_836_840   0.0151-0.0114j -0.0218-0.0099j  0.0023+0.0207j
line_836_862  -0.0000+0.0001j -0.0284-0.0170j -0.0000-0.0000j
line_842_844   0.1887+0.0616j -0.0651-0.2174j -0.1559+0.1562j
line_844_846   0.0292+0.1097j  0.0477-0.1035j -0.1140-0.0179j
line_846_848   0.0292+0.1089j  0.0715-0.0885j -0.1138-0.0312j
line_850_816   0.6148-0.1455j -0.3821-0.4059j -0.1641+0.4150j
line_852r_832  0.3936-0.0477j -0.3411-0.3609j -0.1500+0.3925j
line_854_856   0.0000+0.0000j  0.0010-0.0031j  0.0000+0.0000j
line_854_852   0.3935-0.0397j -0.3352-0.3658j -0.1562+0.3889j
line_858_864   0.0011-0.0004j  0.0000+0.0000j  0.0000+0.0000j
line_858_834   0.3526-0.0409j -0.1949-0.2846j -0.1499+0.3452j
line_860_836   0.0404-0.0256j -0.0707-0.0388j  0.0020+0.0455j
line_862_838   0.0000+0.0000j -0.0139-0.0087j  0.0000+0.0000j
line_888_890   0.0265+0.0001j -0.1376-0.0701j  0.0006+0.0329j


COMPARE Stx
Max |diff|:
A.(fbs - dss)   0.6249
B.(fbs - dss)   0.5557
C.(fbs - dss)   0.4427
dtype: float64
                A.(fbs - dss)   B.(fbs - dss)   C.(fbs - dss)
creg1a            nan+0.0000j     nan-0.0000j     nan+0.0000j
creg2a            nan+0.0000j     nan-0.0000j     nan+0.0000j
line_800_802  -0.6133-0.1197j -0.5461-0.1031j -0.4406-0.0429j
line_802_806  -0.6122-0.1197j -0.5452-0.1029j -0.4401-0.0431j
line_806_808  -0.6114-0.1196j -0.5447-0.1028j -0.4397-0.0433j
line_808_810   0.0000+0.0000j  0.0001+0.0010j  0.0000+0.0000j
line_808_812  -0.5966-0.1182j -0.5350-0.1023j -0.4338-0.0463j
line_812_814  -0.5794-0.1156j -0.5244-0.1008j -0.4268-0.0496j
line_814r_850 -0.3686-0.0136j -0.4593-0.0712j -0.3970-0.0413j
line_816_818  -0.0070+0.0043j -0.0000+0.0000j  0.0000+0.0000j
line_816_824  -0.3613-0.0179j -0.4592-0.0712j -0.3969-0.0413j
line_818_820  -0.0064+0.0045j  0.0000+0.0000j  0.0000+0.0000j
line_820_822  -0.0022+0.0005j  0.0000+0.0000j  0.0000+0.0000j
line_824_826   0.0000+0.0000j  0.0008+0.0008j  0.0000+0.0000j
line_824_828  -0.3585-0.0190j -0.4558-0.0719j -0.3939-0.0415j
line_828_830  -0.3581-0.0190j -0.4554-0.0719j -0.3936-0.0414j
line_830_854  -0.3516-0.0204j -0.4472-0.0718j -0.3869-0.0415j
line_832_858   0.0001-0.1512j  0.0204-0.0884j -0.0252-0.1261j
line_834_842   0.0006-0.1535j  0.0129-0.0965j -0.0132-0.1228j
line_834_860   0.0003+0.0007j  0.0067+0.0057j -0.0074-0.0031j
line_836_840   0.0001+0.0001j  0.0012+0.0009j -0.0011-0.0005j
line_836_862   0.0000+0.0001j  0.0018+0.0016j  0.0000+0.0000j
line_842_844   0.0006-0.1535j  0.0129-0.0965j -0.0132-0.1228j
line_844_846   0.0002-0.0917j  0.0035-0.0613j -0.0022-0.0695j
line_846_848   0.0001-0.0924j  0.0020-0.0627j -0.0015-0.0698j
line_850_816  -0.3685-0.0136j -0.4593-0.0712j -0.3970-0.0413j
line_852r_832  0.1369-0.0688j  0.0615-0.0723j  0.1085-0.0576j
line_854_852  -0.3514-0.0205j -0.4472-0.0751j -0.3867-0.0415j
line_854_856   0.0000+0.0000j  0.0001+0.0033j  0.0000+0.0000j
line_858_834   0.0005-0.1520j  0.0202-0.0894j -0.0241-0.1264j
line_858_864  -0.0000+0.0002j -0.0000+0.0000j  0.0000+0.0000j
line_860_836   0.0001+0.0006j  0.0042+0.0037j -0.0025-0.0007j
line_862_838   0.0000-0.0000j  0.0009+0.0011j  0.0000+0.0000j
line_888_890   0.1369+0.0826j  0.0436+0.0219j  0.1340+0.0689j
subxf             nan-0.0000j     nan+0.0230j     nan+0.0140j
xfm1              nan+0.0812j     nan+0.0829j     nan+0.0828j 

FBS results
                           A               B              C
line_800_802  0.0000-0.0000j  0.0460+0.0230j 0.0250+0.0140j
line_802_806  0.0000+0.0000j  0.0310+0.0155j 0.0125+0.0070j
line_806_808  0.0000+0.0000j  0.0160+0.0080j 0.0000+0.0000j
line_808_810  0.0000+0.0000j  0.0080+0.0040j 0.0000+0.0000j
line_808_812  0.0000+0.0000j -0.0000+0.0000j 0.0000+0.0000j
line_812_814  0.0000+0.0000j -0.0000+0.0000j 0.0000+0.0000j
line_814r_850 0.1971+0.0994j  0.0566+0.0280j 0.0240+0.0105j
line_816_818  0.1725+0.0889j -0.0000+0.0000j 0.0000+0.0000j
line_816_824  0.0245+0.0105j  0.0553+0.0275j 0.0228+0.0100j
line_818_820  0.1554+0.0803j  0.0000+0.0000j 0.0000+0.0000j
line_820_822  0.0677+0.0351j  0.0000+0.0000j 0.0000+0.0000j
line_824_826  0.0000+0.0000j  0.0200+0.0100j 0.0000+0.0000j
line_824_828  0.0245+0.0105j  0.0140+0.0070j 0.0195+0.0085j
line_828_830  0.0210+0.0090j  0.0140+0.0070j 0.0175+0.0075j
line_830_854  0.0000+0.0000j  0.0040+0.0020j 0.0000+0.0000j
line_832_858  0.3165-0.1274j  0.3316-0.0819j 0.3238-0.0990j
line_834_860  0.1055+0.0618j  0.1061+0.0620j 0.0985+0.0588j
line_834_842  0.1643-0.2126j  0.2033-0.1552j 0.1753-0.1834j
line_836_840  0.0135+0.0093j  0.0190+0.0120j 0.0145+0.0098j
line_836_862  0.0000-0.0000j  0.0280+0.0140j 0.0000+0.0000j
line_842_844  0.1598-0.2151j  0.2032-0.1552j 0.1753-0.1834j
line_844_846  0.0202-0.1872j  0.0556-0.1465j 0.0302-0.1678j
line_846_848  0.0200-0.1873j  0.0315-0.1581j 0.0200-0.1734j
line_850_816  0.1971+0.0994j  0.0566+0.0280j 0.0240+0.0105j
line_852r_832 0.4794-0.0447j  0.4936+0.0021j 0.4859-0.0152j
line_854_856  0.0000+0.0000j  0.0020+0.0010j 0.0000+0.0000j
line_854_852  0.0000+0.0000j -0.0000+0.0000j 0.0000+0.0000j
line_858_864  0.0010+0.0005j -0.0000+0.0000j 0.0000+0.0000j
line_858_834  0.3063-0.1325j  0.3239-0.0857j 0.3141-0.1042j
line_860_836  0.0360+0.0208j  0.0670+0.0363j 0.0330+0.0195j
line_862_838  0.0000-0.0000j  0.0140+0.0070j 0.0000+0.0000j
line_888_890  0.1597+0.0812j  0.1597+0.0829j 0.1600+0.0828j
creg1a        0.0000+0.0000j  0.0000-0.0000j 0.0000+0.0000j
creg2a        0.0000+0.0000j  0.0000-0.0000j 0.0000+0.0000j
subxf         0.0000-0.0000j  0.0460+0.0230j 0.0250+0.0140j
xfm1          0.1597+0.0812j  0.1597+0.0829j 0.1600+0.0828j 

DSS results
                            A              B               C
line_800_802   0.6133+0.1197j 0.5921+0.1261j  0.4656+0.0570j
line_802_806   0.6122+0.1197j 0.5762+0.1184j  0.4526+0.0501j
line_806_808   0.6114+0.1196j 0.5607+0.1108j  0.4397+0.0433j
line_808_810   0.0000+0.0000j 0.0079+0.0030j  0.0000+0.0000j
line_808_812   0.5966+0.1182j 0.5350+0.1023j  0.4338+0.0463j
line_812_814   0.5794+0.1156j 0.5244+0.1008j  0.4268+0.0496j
line_814r_850  0.5656+0.1130j 0.5159+0.0993j  0.4210+0.0518j
line_816_818   0.1795+0.0845j 0.0000+0.0000j  0.0000+0.0000j
line_816_824   0.3859+0.0284j 0.5146+0.0988j  0.4196+0.0513j
line_818_820   0.1618+0.0758j 0.0000+0.0000j  0.0000+0.0000j
line_820_822   0.0698+0.0346j 0.0000+0.0000j  0.0000+0.0000j
line_824_826   0.0000+0.0000j 0.0192+0.0092j  0.0000+0.0000j
line_824_828   0.3830+0.0295j 0.4698+0.0789j  0.4134+0.0500j
line_828_830   0.3791+0.0280j 0.4694+0.0789j  0.4111+0.0489j
line_830_854   0.3516+0.0204j 0.4512+0.0738j  0.3869+0.0415j
line_832_858   0.3164+0.0238j 0.3112+0.0065j  0.3491+0.0271j
line_834_860   0.1053+0.0610j 0.0994+0.0563j  0.1060+0.0618j
line_834_842   0.1637-0.0591j 0.1903-0.0587j  0.1885-0.0606j
line_836_840   0.0134+0.0091j 0.0178+0.0111j  0.0156+0.0103j
line_836_862  -0.0000-0.0001j 0.0262+0.0124j -0.0000-0.0000j
line_842_844   0.1592-0.0616j 0.1903-0.0586j  0.1885-0.0606j
line_844_846   0.0200-0.0955j 0.0521-0.0853j  0.0323-0.0983j
line_846_848   0.0200-0.0949j 0.0295-0.0954j  0.0215-0.1036j
line_850_816   0.5656+0.1130j 0.5159+0.0993j  0.4210+0.0518j
line_852r_832  0.3426+0.0241j 0.4321+0.0743j  0.3774+0.0424j
line_854_856   0.0000+0.0000j 0.0019-0.0023j  0.0000+0.0000j
line_854_852   0.3514+0.0205j 0.4472+0.0751j  0.3867+0.0415j
line_858_864   0.0010+0.0003j 0.0000+0.0000j  0.0000+0.0000j
line_858_834   0.3058+0.0195j 0.3037+0.0037j  0.3382+0.0223j
line_860_836   0.0359+0.0201j 0.0628+0.0326j  0.0355+0.0202j
line_862_838   0.0000+0.0000j 0.0131+0.0059j  0.0000+0.0000j
line_888_890   0.0228-0.0014j 0.1161+0.0611j  0.0261+0.0139j


COMPARE Srx
Max |diff|:
A.(fbs - dss)   0.6237
B.(fbs - dss)   0.5548
C.(fbs - dss)   0.4422
dtype: float64
                A.(fbs - dss)   B.(fbs - dss)   C.(fbs - dss)
creg1a            nan+0.0000j     nan-0.0000j     nan+0.0000j
creg2a            nan+0.0000j     nan-0.0000j     nan+0.0000j
line_800_802  -0.6122-0.1197j -0.5452-0.1029j -0.4401-0.0431j
line_802_806  -0.6114-0.1196j -0.5447-0.1028j -0.4398-0.0433j
line_806_808  -0.5966-0.1182j -0.5348-0.1013j -0.4338-0.0463j
line_808_810   0.0000+0.0000j  0.0001+0.0001j  0.0000+0.0000j
line_808_812  -0.5794-0.1156j -0.5244-0.1008j -0.4268-0.0496j
line_812_814  -0.5657-0.1132j -0.5160-0.0994j -0.4211-0.0520j
line_814r_850 -0.3685-0.0136j -0.4593-0.0712j -0.3970-0.0413j
line_816_818  -0.0070+0.0041j  0.0000+0.0000j  0.0000+0.0000j
line_816_824  -0.3585-0.0190j -0.4541-0.0706j -0.3940-0.0415j
line_818_820  -0.0048-0.0011j  0.0000+0.0000j  0.0000+0.0000j
line_820_822  -0.0021-0.0012j  0.0000+0.0000j  0.0000+0.0000j
line_824_826   0.0000+0.0000j  0.0008+0.0004j  0.0000+0.0000j
line_824_828  -0.3583-0.0191j -0.4554-0.0719j -0.3936-0.0415j
line_828_830  -0.3526-0.0209j -0.4467-0.0715j -0.3878-0.0419j
line_830_854  -0.3514-0.0205j -0.4470-0.0718j -0.3867-0.0415j
line_832_858   0.0004-0.1519j  0.0207-0.0892j -0.0248-0.1268j
line_834_842   0.0006-0.1535j  0.0129-0.0965j -0.0132-0.1228j
line_834_860   0.0003+0.0004j  0.0067+0.0054j -0.0074-0.0034j
line_836_840   0.0000-0.0000j  0.0012+0.0008j -0.0011-0.0007j
line_836_862  -0.0000-0.0000j  0.0018+0.0016j  0.0000+0.0000j
line_842_844   0.0005-0.1538j  0.0130-0.0968j -0.0132-0.1231j
line_844_846   0.0001-0.0924j  0.0036-0.0619j -0.0023-0.0702j
line_846_848   0.0000-0.0925j  0.0020-0.0628j -0.0015-0.0699j
line_850_816  -0.3684-0.0136j -0.4592-0.0712j -0.3969-0.0413j
line_852r_832  0.1369-0.0688j  0.0615-0.0723j  0.1085-0.0576j
line_854_852  -0.3426-0.0242j -0.4322-0.0745j -0.3774-0.0425j
line_854_856   0.0000+0.0000j  0.0001+0.0001j  0.0000+0.0000j
line_858_834   0.0009-0.1529j  0.0205-0.0903j -0.0236-0.1272j
line_858_864  -0.0000-0.0000j  0.0000-0.0000j  0.0000+0.0000j
line_860_836   0.0001+0.0001j  0.0043+0.0032j -0.0025-0.0012j
line_862_838   0.0000+0.0000j  0.0009+0.0005j  0.0000+0.0000j
line_888_890   0.1274+0.0758j  0.0448+0.0238j  0.1237+0.0614j
subxf             nan-0.0000j     nan+0.0230j     nan+0.0140j
xfm1              nan+0.0812j     nan+0.0829j     nan+0.0828j 

FBS results
                           A               B              C
line_800_802  0.0000+0.0000j  0.0460+0.0230j 0.0250+0.0140j
line_802_806  0.0000+0.0000j  0.0310+0.0155j 0.0125+0.0070j
line_806_808  0.0000+0.0000j  0.0160+0.0080j 0.0000+0.0000j
line_808_810  0.0000+0.0000j  0.0080+0.0040j 0.0000+0.0000j
line_808_812  0.0000+0.0000j -0.0000+0.0000j 0.0000+0.0000j
line_812_814  0.0000+0.0000j -0.0000+0.0000j 0.0000+0.0000j
line_814r_850 0.1971+0.0994j  0.0566+0.0280j 0.0240+0.0105j
line_816_818  0.1724+0.0888j  0.0000+0.0000j 0.0000+0.0000j
line_816_824  0.0245+0.0105j  0.0553+0.0275j 0.0228+0.0100j
line_818_820  0.1522+0.0786j  0.0000+0.0000j 0.0000+0.0000j
line_820_822  0.0675+0.0350j  0.0000+0.0000j 0.0000+0.0000j
line_824_826  0.0000+0.0000j  0.0200+0.0100j 0.0000+0.0000j
line_824_828  0.0245+0.0105j  0.0140+0.0070j 0.0195+0.0085j
line_828_830  0.0210+0.0090j  0.0140+0.0070j 0.0175+0.0075j
line_830_854  0.0000+0.0000j  0.0040+0.0020j 0.0000+0.0000j
line_832_858  0.3158-0.1277j  0.3309-0.0822j 0.3231-0.0994j
line_834_860  0.1055+0.0618j  0.1060+0.0620j 0.0985+0.0588j
line_834_842  0.1643-0.2126j  0.2032-0.1552j 0.1753-0.1834j
line_836_840  0.0135+0.0093j  0.0190+0.0120j 0.0145+0.0098j
line_836_862  0.0000-0.0000j  0.0280+0.0140j 0.0000+0.0000j
line_842_844  0.1597-0.2151j  0.2031-0.1552j 0.1752-0.1834j
line_844_846  0.0200-0.1873j  0.0555-0.1466j 0.0300-0.1679j
line_846_848  0.0200-0.1873j  0.0315-0.1581j 0.0200-0.1734j
line_850_816  0.1971+0.0994j  0.0566+0.0280j 0.0240+0.0105j
line_852r_832 0.4794-0.0447j  0.4936+0.0021j 0.4859-0.0152j
line_854_856  0.0000+0.0000j  0.0020+0.0010j 0.0000+0.0000j
line_854_852  0.0000+0.0000j -0.0000+0.0000j 0.0000+0.0000j
line_858_864  0.0010+0.0005j  0.0000-0.0000j 0.0000+0.0000j
line_858_834  0.3056-0.1328j  0.3231-0.0861j 0.3133-0.1046j
line_860_836  0.0360+0.0208j  0.0670+0.0363j 0.0330+0.0195j
line_862_838  0.0000+0.0000j  0.0140+0.0070j 0.0000+0.0000j
line_888_890  0.1500+0.0750j  0.1500+0.0750j 0.1500+0.0750j
creg1a        0.0000+0.0000j  0.0000-0.0000j 0.0000+0.0000j
creg2a        0.0000+0.0000j  0.0000-0.0000j 0.0000+0.0000j
subxf         0.0000-0.0000j  0.0460+0.0230j 0.0250+0.0140j
xfm1          0.1597+0.0812j  0.1597+0.0829j 0.1600+0.0828j 

DSS results
                           A              B               C
line_800_802  0.6122+0.1197j 0.5912+0.1259j  0.4651+0.0571j
line_802_806  0.6114+0.1196j 0.5757+0.1183j  0.4523+0.0503j
line_806_808  0.5966+0.1182j 0.5508+0.1093j  0.4338+0.0463j
line_808_810  0.0000+0.0000j 0.0079+0.0039j  0.0000+0.0000j
line_808_812  0.5794+0.1156j 0.5244+0.1008j  0.4268+0.0496j
line_812_814  0.5657+0.1132j 0.5160+0.0994j  0.4211+0.0520j
line_814r_850 0.5656+0.1130j 0.5159+0.0993j  0.4210+0.0518j
line_816_818  0.1793+0.0846j 0.0000+0.0000j  0.0000+0.0000j
line_816_824  0.3830+0.0295j 0.5094+0.0981j  0.4168+0.0515j
line_818_820  0.1569+0.0797j 0.0000+0.0000j  0.0000+0.0000j
line_820_822  0.0696+0.0362j 0.0000+0.0000j  0.0000+0.0000j
line_824_826  0.0000+0.0000j 0.0192+0.0096j  0.0000+0.0000j
line_824_828  0.3828+0.0296j 0.4694+0.0789j  0.4132+0.0500j
line_828_830  0.3736+0.0299j 0.4607+0.0785j  0.4053+0.0494j
line_830_854  0.3514+0.0205j 0.4510+0.0738j  0.3867+0.0415j
line_832_858  0.3154+0.0242j 0.3103+0.0069j  0.3479+0.0274j
line_834_860  0.1052+0.0614j 0.0993+0.0566j  0.1059+0.0622j
line_834_842  0.1637-0.0591j 0.1903-0.0586j  0.1885-0.0606j
line_836_840  0.0135+0.0093j 0.0178+0.0112j  0.0156+0.0104j
line_836_862  0.0000+0.0000j 0.0262+0.0124j -0.0000-0.0000j
line_842_844  0.1591-0.0614j 0.1902-0.0584j  0.1884-0.0604j
line_844_846  0.0200-0.0949j 0.0520-0.0846j  0.0323-0.0977j
line_846_848  0.0200-0.0948j 0.0295-0.0953j  0.0215-0.1035j
line_850_816  0.5654+0.1129j 0.5158+0.0992j  0.4209+0.0519j
line_852r_832 0.3426+0.0241j 0.4321+0.0743j  0.3774+0.0424j
line_854_856  0.0000+0.0000j 0.0019+0.0009j  0.0000+0.0000j
line_854_852  0.3426+0.0242j 0.4322+0.0745j  0.3774+0.0425j
line_858_864  0.0010+0.0005j 0.0000+0.0000j  0.0000+0.0000j
line_858_834  0.3047+0.0200j 0.3026+0.0042j  0.3369+0.0226j
line_860_836  0.0359+0.0206j 0.0627+0.0330j  0.0355+0.0207j
line_862_838  0.0000+0.0000j 0.0131+0.0065j  0.0000+0.0000j
line_888_890  0.0226-0.0008j 0.1052+0.0512j  0.0263+0.0136j


COMPARE TOTAL NODE POWERS

Max |diff|:
A.(fbs - dss)   167.7051
B.(fbs - dss)    63.3202
C.(fbs - dss)   160.7497
dtype: float64
              A.(fbs - dss)    B.(fbs - dss)     C.(fbs - dss)
sourcebus    0.0000+0.0000j   0.0000+0.0000j    0.0000+0.0000j
800          0.0000+0.0000j   0.0000+0.0000j    0.0000+0.0000j
802          0.0000+0.0000j   0.0089+0.0068j   -0.0101-0.0015j
806          0.0000+0.0000j   0.0133+0.0095j   -0.0146-0.0028j
808          0.0000+0.0000j   0.0505+0.0320j    0.0000+0.0000j
810          0.0000+0.0000j   0.0504+0.0320j    0.0000+0.0000j
812          0.0000+0.0000j   0.0000+0.0000j    0.0000+0.0000j
814          0.0000+0.0000j   0.0000+0.0000j    0.0000+0.0000j
814r         0.0000+0.0000j   0.0000+0.0000j    0.0000+0.0000j
850          0.0000+0.0000j   0.0000+0.0000j    0.0000+0.0000j
816          0.0000+0.0000j   0.0227+0.0124j   -0.0287-0.0045j
818         -0.2546-0.3015j   0.0000+0.0000j    0.0000+0.0000j
824          0.0000+0.0000j   0.4324+0.2772j   -0.0864-0.0174j
820         -1.1628-1.4850j   0.0000+0.0000j    0.0000+0.0000j
822         -0.9171-1.1869j   0.0000+0.0000j    0.0000+0.0000j
826          0.0000+0.0000j   0.4064+0.2633j    0.0000+0.0000j
828         -0.0645-0.0645j   0.0000+0.0000j   -0.0542-0.0126j
830         -0.6143-0.2570j   0.2560+0.1614j   -0.4710-0.3081j
854          0.0000+0.0000j   0.0515+0.0324j    0.0000+0.0000j
832         -0.0444-0.0302j   0.0798+0.0446j    0.0007-0.0169j
858         -0.1368-0.0683j   0.2440+0.1508j   -0.0856-0.0623j
834         -1.2859-0.3028j   0.4722+0.2952j    0.6193-0.0434j
860         -0.6227-0.1445j   1.3182+1.0469j   -0.0358-0.4422j
842          0.1550+0.0140j   0.0000+0.0000j    0.0000+0.0000j
836         -0.0710-0.0835j   0.6844+0.4301j   -0.0034-0.0552j
840          0.5120+0.1094j   0.6430+0.4896j   -0.7115-0.2480j
862          0.0000+0.0000j   0.4796+0.2948j    0.0000+0.0000j
844         5.2966-60.2093j  4.9403-38.3105j  -7.2611-48.8075j
846          0.0000+0.0000j   0.8240+0.4870j   -0.4774-0.1195j
848         0.7577-92.2534j  1.0615-63.3113j  -1.0098-69.1985j
852r         0.0000+0.0000j   0.0000+0.0000j    0.0000+0.0000j
888          0.0000+0.0000j   0.0000+0.0000j    0.0000+0.0000j
856          0.0000+0.0000j   0.0514+0.0324j    0.0000+0.0000j
852          0.0000+0.0000j   0.0000+0.0000j    0.0000+0.0000j
864          0.0244-0.0035j   0.0000+0.0000j    0.0000+0.0000j
838          0.0000+0.0000j   0.4794+0.2946j    0.0000+0.0000j
890       150.0000+75.0000j 23.1126+21.0391j 143.7675+71.9124j 

FBS results
                          A                 B                 C
sourcebus    0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
800          0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
802          0.0000+0.0000j   15.0000+7.5000j   12.5000+7.0000j
806          0.0000+0.0000j   15.0000+7.5000j   12.5000+7.0000j
808          0.0000+0.0000j    8.0000+4.0000j    0.0000+0.0000j
810          0.0000+0.0000j    8.0000+4.0000j    0.0000+0.0000j
812          0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
814          0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
814r         0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
850          0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
816          0.0000+0.0000j    1.2500+0.5000j    1.2500+0.5000j
818         17.0000+8.5000j    0.0000+0.0000j    0.0000+0.0000j
824          0.0000+0.0000j  21.2500+10.5000j    3.2500+1.5000j
820        84.5000+43.5000j    0.0000+0.0000j    0.0000+0.0000j
822        67.5000+35.0000j    0.0000+0.0000j    0.0000+0.0000j
826          0.0000+0.0000j  20.0000+10.0000j    0.0000+0.0000j
828          3.5000+1.5000j    0.0000+0.0000j    2.0000+1.0000j
830         21.0000+9.0000j   10.0000+5.0000j   17.5000+7.5000j
854          0.0000+0.0000j    2.0000+1.0000j    0.0000+0.0000j
832          3.2500+1.5000j    2.2500+1.0000j    2.0000+1.0000j
858          8.5000+4.2500j    7.0000+3.5000j    9.0000+4.7500j
834        35.7500+18.0000j   13.7500+7.0000j  39.5000+20.0000j
860        69.5000+41.0000j  39.0000+25.7500j  65.5000+39.2500j
842          4.5000+2.5000j    0.0000+0.0000j    0.0000+0.0000j
836        22.5000+11.5000j  20.0000+10.2500j   18.5000+9.7500j
840         13.5000+9.2500j  19.0000+12.0000j   14.5000+9.7500j
862          0.0000+0.0000j   14.0000+7.0000j    0.0000+0.0000j
844       139.5000-27.9360j  147.5000-8.7014j 145.0000-15.6622j
846          0.0000+0.0000j  24.0000+11.5000j   10.0000+5.5000j
848       20.0000-187.2947j 31.5000-158.0717j 20.0000-173.3688j
852r         0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
888          0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
856          0.0000+0.0000j    2.0000+1.0000j    0.0000+0.0000j
852          0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
864          1.0000+0.5000j    0.0000+0.0000j    0.0000+0.0000j
838          0.0000+0.0000j   14.0000+7.0000j    0.0000+0.0000j
890       150.0000+75.0000j 150.0000+75.0000j 150.0000+75.0000j 

DSS results
                          A                 B                 C
sourcebus    0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
800          0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
802          0.0000+0.0000j   14.9911+7.4932j   12.5101+7.0015j
806          0.0000+0.0000j   14.9867+7.4905j   12.5146+7.0028j
808          0.0000+0.0000j    7.9495+3.9680j    0.0000+0.0000j
810          0.0000+0.0000j    7.9496+3.9680j    0.0000+0.0000j
812          0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
814          0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
814r         0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
850          0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
816          0.0000+0.0000j    1.2273+0.4876j    1.2787+0.5045j
818         17.2546+8.8015j    0.0000+0.0000j    0.0000+0.0000j
824          0.0000+0.0000j  20.8176+10.2228j    3.3364+1.5174j
820        85.6628+44.9850j    0.0000+0.0000j    0.0000+0.0000j
822        68.4171+36.1869j    0.0000+0.0000j    0.0000+0.0000j
826          0.0000+0.0000j   19.5936+9.7367j    0.0000+0.0000j
828          3.5645+1.5645j    0.0000+0.0000j    2.0542+1.0126j
830         21.6143+9.2570j    9.7440+4.8386j   17.9710+7.8081j
854          0.0000+0.0000j    1.9485+0.9676j    0.0000+0.0000j
832          3.2944+1.5302j    2.1702+0.9554j    1.9993+1.0169j
858          8.6368+4.3183j    6.7560+3.3492j    9.0856+4.8123j
834        37.0359+18.3028j   13.2778+6.7048j  38.8807+20.0434j
860        70.1227+41.1445j  37.6818+24.7031j  65.5358+39.6922j
842          4.3450+2.4860j    0.0000+0.0000j    0.0000+0.0000j
836        22.5710+11.5835j   19.3156+9.8199j   18.5034+9.8052j
840         12.9880+9.1406j  18.3570+11.5104j   15.2115+9.9980j
862          0.0000+0.0000j   13.5204+6.7052j    0.0000+0.0000j
844       134.2034+32.2733j 142.5597+29.6091j 152.2611+33.1453j
846          0.0000+0.0000j  23.1760+11.0130j   10.4774+5.6195j
848        19.2423-95.0413j  30.4385-94.7604j 21.0098-104.1703j
852r         0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
888          0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
856          0.0000+0.0000j    1.9486+0.9676j    0.0000+0.0000j
852          0.0000+0.0000j    0.0000+0.0000j    0.0000+0.0000j
864          0.9756+0.5035j    0.0000+0.0000j    0.0000+0.0000j
838          0.0000+0.0000j   13.5206+6.7054j    0.0000+0.0000j
890          0.0000+0.0000j 126.8874+53.9609j    6.2325+3.0876j
F

=================================== FAILURES ===================================
___________________________________ test_all ___________________________________

    def test_all():
        """
        Compare the python FBS solution to the opendss solution.
        To save output, run from command line:
        pytest ./fbs/tests/test_compare_opendss.py -s >[OUTPUT FILE PATH]
        Examples:
        $ pytest ./fbs/tests/test_compare_opendss.py -s > ./fbs/tests/06n3ph_unbal/06n3ph_out.txt
        $ pytest ./fbs/tests/test_compare_opendss.py -s > ./fbs/tests/05n3ph_unbal/05n3ph_out.txt
        """
        tolerance = 10**-1
        for file in dss_files:
            print(f'\n\nTesting File: {file}')
>           compare_fbs_sol(file, tolerance)

fbs/tests/test_compare_opendss.py:42: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

dss_file = 'fbs/tests/IEEE_34_feeder_UB/IEEE_34_Bus_allwye.dss', tolerance = 0.1

    def compare_fbs_sol(dss_file, tolerance):
        # TODO: Figure out how to get Inode (iNR) and sV (sNR) at each node from dss and perform a compare
        # solve with fbs
        network = init_from_dss(dss_file)
        fbs_sol = get_fbs_solution(fbs(network))
    
        # solve with dss
        dss_sol = solve_with_dss(dss_file)
    
        fbsV, fbsI, fbsStx, fbsSrx, fbs_sV = fbs_sol.V_df(), fbs_sol.I_df(), fbs_sol.Stx_df(), \
            fbs_sol.Srx_df(), fbs_sol.sV_df()
        dssV, dssI, dssStx, dssSrx, dssLoads, dss = dss_sol
    
        target_loads = ['S848']
        for load in target_loads:
            dss.Loads.Name(load)
            dss_load_powers = dss.CktElement.Powers()
            fbs_load_powers = fbs_sol.sV['848']
            print(f"Opendss Load Powers at 848: {dss_load_powers}")
            print(f"FBS Load Powers at 848: {fbs_load_powers}")
    
        print("\n\n")
    
        for cap in network.capacitors.values():
            print(f"FBS Capacitor powers at {cap.name}: {cap.imag}")
            dss.Capacitors.Name(cap.name)
            dss_powers = dss.CktElement.Powers()
            print(f"OpenDSS Capacitor powers at {cap.name}: {dss_powers}")
    
    
        print(f"FBS iterations: {fbs_sol.iterations}\t FBS convergence:{fbs_sol.diff}\t FBS tolerance: {fbs_sol.tolerance}")
        print("\n\nCOMPARE V")
        V_maxDiff = compare_dfs(fbsV, dssV)
        print("\n\nCOMPARE I")
        I_maxDiff = compare_dfs(fbsI, dssI)
        print("\n\nCOMPARE Stx")
        Stx_maxDiff = compare_dfs(fbsStx, dssStx)
        print("\n\nCOMPARE Srx")
        Srx_maxDiff = compare_dfs(fbsSrx, dssSrx)
    
        print("\n\nCOMPARE TOTAL NODE POWERS\n")
        fbsLoads = fbs_sV.multiply(1000)
    
        loads_maxDiff = compare_dfs(fbsLoads, dssLoads)
    
>       assert (V_maxDiff <= tolerance).all()
E       assert False
E        +  where False = <bound method Series.all of A.(fbs - dss)    False\nB.(fbs - dss)    False\nC.(fbs - dss)    False\ndtype: bool>()
E        +    where <bound method Series.all of A.(fbs - dss)    False\nB.(fbs - dss)    False\nC.(fbs - dss)    False\ndtype: bool> = A.(fbs - dss)   0.3096\nB.(fbs - dss)   0.2824\nC.(fbs - dss)   0.2367\ndtype: float64 <= 0.1.all

fbs/tests/test_compare_opendss.py:91: AssertionError
=============================== warnings summary ===============================
tests/test_compare_opendss.py::test_all
  /Users/elainelaguerta/Dropbox/LBNL/LinDist3Flow/fbs/fbs/solution.py:182: RuntimeWarning: invalid value encountered in true_divide
    new_line_I = np.conj(np.divide(node_s, node_V))

tests/test_compare_opendss.py::test_all
  /Users/elainelaguerta/Dropbox/LBNL/LinDist3Flow/fbs/fbs/solution.py:212: ComplexWarning: Casting complex values to real discards the imaginary part
    Itx[idx] = gamma * Ireg[idx]

tests/test_compare_opendss.py::test_all
  /Users/elainelaguerta/Dropbox/LBNL/LinDist3Flow/fbs/fbs/solution.py:279: RuntimeWarning: invalid value encountered in true_divide
    node_I = np.conj(np.divide(node_sV,node_V))

-- Docs: https://docs.pytest.org/en/stable/warnings.html
=========================== short test summary info ============================
FAILED fbs/tests/test_compare_opendss.py::test_all - assert False
======================== 1 failed, 3 warnings in 2.86s =========================
